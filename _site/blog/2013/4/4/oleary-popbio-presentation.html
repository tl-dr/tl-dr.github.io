
<!DOCTYPE html> 
<!--
	Noam's theme, based on Readnik scriptogr.am theme
-->
<html lang="en">
<head>
  <title>Noam Ross | Demographic analysis using the `popbio` library and some other fun stuff</title>
  <meta name="description" content=" " />
  <meta name="author" content="Noam Ross">
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="ROBOTS" content="INDEX,FOLLOW">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta property="og:url" content="">
  <meta property="og:site_name" content="Noam Ross">
  <link rel="icon" type="image/x-icon" href="/assets/themes/noamblog/atom.ico">
  <link href="/assets/themes/noamblog/css/style.css" rel="stylesheet" type="text/css" media="all">
  <link href="http://feeds.feedburner.com/noamross" rel="alternate" type="application/rss+xml" title="Noam Ross" />
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30394461-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
 </script>
 <script type="text/javascript"> 
    function typeset() {
      MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
    function disqus_config() {
      this.callbacks.onNewComment = [typeset];
      this.callbacks.onInit = [typeset];
    }
  </script>
  <script src="http://cachedcommons.org/javascripts/text/prettify-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/text/showdown-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/jquery/jquery.disqus.js" type="text/javascript"></script>
  <script type="text/javascript" src="/assets/themes/noamblog/app.js"></script>  
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ "HTML-CSS": { availableFonts: ["TeX"], webfont: [null] }} ); </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ TeX: { extensions: ["autobold.js"] }} ); </script>
  <script type="text/javascript">var switchTo5x=true;</script>
  <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
  <script type="text/javascript">stLight.options({publisher: "4376beef-ffcc-441e-a877-904acf7f379b", theme:'8', onhover:false, doNotHash:true, doNotCopy:true, hashAddressBar:false}); </script>
  <script type="text/javascript">
      function chgifr(url, iframe)  {
          document.getElementById(iframe).src = url;
      }
  </script>
  <script type="text/javascript">
      function showhide(id) {
           var e = document.getElementById(id);
           if(e.style.display == 'block')
              e.style.display = 'none';
           else
              e.style.display = 'block';
        }
  </script>
</head>
<body>
<div class="wrapper">
  <div class="blog">
 
      <div id="menu" class="menu-top">
        <div class="blog-info">
          <h1><a href="/index.html">Noam Ross</a></h1>
          <div class="blog-description">
           <h2>Real-time research in ecology, economics, and sustainability</h2>
          </div>
         </div>
          <div class="pages">
            
            <!-- Lockerz Share BEGIN -->
            <a class="a2a_dd" href="http://www.addtoany.com/share_save" tile"Share this Page"><span class="shareicon"><span class="hide">Share</span></span></a>
            <script type="text/javascript">
            var a2a_config = a2a_config || {};
            a2a_config.onclick = 0;
            a2a_config.show_title = 1;
            a2a_config.color_main = "FFFFFF";
            a2a_config.color_border = "FFFFFF";
            a2a_config.color_link_text = "45462f";
            a2a_config.color_link_text_hover = "575757";
            a2a_config.prioritize = ["twitter", "facebook", "tumblr", "email", "delicious", "linkedin", "stumbleupon", "google_plus"];
            </script>
            <script type="text/javascript" src="http://static.addtoany.com/menu/page.js"></script>
            <!-- Lockerz Share END -->
            
            <a href="http://feeds.feedburner.com/noamross" title="Subscribe via Feedburner RSS"> <span class="rssicon"> <span class="hide">RSS</span></span></a>
            
             
             
            


  
    
  
    
    	
    	<a href="/about.html">About</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/connect.html">Connect</a>
    	
    
  
    
  
    
    	
    	<a href="/index.html">Blog</a>
    	
    
  
    
  
    
  
    
    	
    	<a href="/publications.html">Publications</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/tags.html">Topics</a>
    	
    
  
    
  



            
        </div>
      </div>

      <div class="container">

        <div class="content">
          
<div id="headblock">
<h1 id="page.title"><a href="/blog/2013/4/4/oleary-popbio-presentation.html">Demographic analysis using the `popbio` library and some other fun stuff</a></h1>
<p>by <em>Kara Moore O'Leary</em>, 04 April 2013</p>
<hr />
</div>
<div class="contenttext"><p><p><em>This week at the <a href="http://www.noamross.net/davis-r-users-group.html">Davis R Users’ Group</a> we had a great presentation by Kara Moore O’Leary on using the <a href="http://cran.r-project.org/web/packages/popbio/"><code>popbio</code> package</a> to examine rare plant demographics. The following is her script run through <code>knitr</code>. You can download the original script and associated data <a href="https://gist.github.com/noamross/bf8ebdcf42fd2e0851a8">here</a>. Find out more about Kara and her work at her website <a href="http://dynamicecosciences.wordpress.com/">here</a></em></p>
<h2 id="demographic-analysis-using-the-popbio-library-and-some-other-fun-stuff">Demographic analysis using the popbio library and some other fun stuff</h2>
<p><strong>A population viability type analysis for a rare herbacious perennial plant, <em>Penstemon albomarginatus</em>, for its only remaining California population</strong></p>
<p>Objectives:</p>
<ol style="list-style-type: decimal">
<li>Estimating the population growth rate - deterministic and stochastic methods</li>
<li>Sensitivity and elasticity analysis - which transitions/rate are most variable, sensitive to change</li>
<li>Projecting the population stochastically for different scenarios, observing variation in growth rate</li>
<li>Quasi extinction probability</li>
<li>Estimating vital rates from real data, which will never be as good/much the data that you would like to have for a PVA - some therapy for me, and maybe you too</li>
</ol>
<p>Load popbio and some other helpful libraries. I use the dropdown menu in RStudio to install libraries, it seems to work more consistently for my mac than scripting the installs, sorry.<br />Am I missing something basic about installing packages?</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(popbio)
<span class="kw">library</span>(plyr)
<span class="kw">library</span>(reshape)</code></pre>
<p>I have already done a bit of magic on my data get here, most or all of which is suggested in the Morris and Doak 2005 book Quantitative population biology. That book was an excellent guide to this kind of analysis. If you want to go deep (and deeper) into this kind of analysis you should get borrow or steal Morris and Doak 2005 and Caswell 2002 from the start! They are both really excellent and straightforward and you’ll be able to answer a lot of the questions that you have along the way. Most of the functions in popbio are based on functions in these two books. Many of the popbio examples are on their data and generate the same graphs etc.</p>
<p>What you need for a class/stage structured demographic model:</p>
<ul>
<li>a bunch of individuals (maybe in different populations)</li>
<li>annual survival rates</li>
<li>annual class or stage transition rates</li>
<li>annual fecundity, ie. probability of contribution to the juvenile class in the next year</li>
<li>these data for a lot of years, preferably 10 or more (but we do what we can with less)</li>
</ul>
<p>The crux for plants is that its challenging to 1) count all seeds produced annually and 2) know how many seeds really yeilds a juvenile in any year. I am doing a bit of work on these issues from limited field data. If you have a well behaved penguin that you can collar and track and you know produces 2 live juveniles each season, your PVA might be a bit simpler.</p>
<p>Our field data had surivival for each year, mean plant diameter, and inflorescence count classes. From this I found the median inflorescence number for each class MEDIAN_INLF I assigned each plant to CLASS based on its xDIAM_cm. I convinced myself that this had biological meaning by looking at the relationship between size class and survival. Whatever classes or stages you use, you should be confident that they are meaningful for your study species. OR use an integral projection model (IPM) instead. These allow you to use continuous variables like size or age rather than classes. nice abbreviated dataset</p>
<pre class="sourceCode r"><code class="sourceCode r">andre &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;karadat.csv&quot;</span>)
<span class="kw">str</span>(andre)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## &#39;data.frame&#39;:    1221 obs. of  4 variables:
##  $ PLANT_UNQ: Factor w/ 395 levels &quot;1_703&quot;,&quot;1_704&quot;,..: 238 240 249 253 258 263 250 255 259 239 ...
##  $ YEAR     : int  1994 1994 1994 1994 1994 1994 1994 1994 1994 1994 ...
##  $ CLASS    : Factor w/ 6 levels &quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,..: 1 1 1 1 1 1 2 2 2 3 ...
##  $ SEEDS    : num  71.8 0 71.8 0 71.8 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head2</span>(andre)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      PLANT_UNQ YEAR CLASS SEEDS
## 1          A_1 1994    A1 71.75
## 2          A_3 1994    A1  0.00
## 3         B_13 1994    A1 71.75
## .            .    .     .     .
## 1221    6_772A 2012     J  0.00</code></pre>
<p>Let’s look at the stages/classes</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">levels</span>(andre$CLASS)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] &quot;A1&quot;   &quot;A2&quot;   &quot;A3&quot;   &quot;A4&quot;   &quot;dead&quot; &quot;J&quot;</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># dead. After that it can be omitted.</span></code></pre>
<h2 id="estimating-fecundity">1. ESTIMATING FECUNDITY</h2>
<p>The big challenge for plants = estimating seeds/indiv –&gt; juveniles produced the next year based on a few fruit and seed counts and a lot of inflorescence class data</p>
<h3 id="part-1-how-to-estimate-seed-production-per-plant">Part 1: How to estimate seed production per plant?</h3>
<p>Multiply seeds/infl from field observations by inflorescence number. Ideally you would have seed counts for each plant, but in the absence of those nearly impossible data, I’m using a few seeds/fruit counts * fruits/infl counts from 2011 and 2012.</p>
<h3 id="part-2-how-many-seeds-makes-an-emergent-juvenile">Part 2: How many seeds makes an emergent juvenile?</h3>
<p>I’ll add some notes on how I made these estimates at the end of this script, but let’s start today with a dataset ready to go for popbio I’m sure that every PVA has a hurdle or five to leap before you have the vital rate data ready to go. I’ve added estimated seeds produced per individual per year as a column in this simple dataset more on how I generated that later if we are interested</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(andre)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## &#39;data.frame&#39;:    1221 obs. of  4 variables:
##  $ PLANT_UNQ: Factor w/ 395 levels &quot;1_703&quot;,&quot;1_704&quot;,..: 238 240 249 253 258 263 250 255 259 239 ...
##  $ YEAR     : int  1994 1994 1994 1994 1994 1994 1994 1994 1994 1994 ...
##  $ CLASS    : Factor w/ 6 levels &quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,..: 1 1 1 1 1 1 2 2 2 3 ...
##  $ SEEDS    : num  71.8 0 71.8 0 71.8 ...</code></pre>
<h2 id="pick-a-starting-population-vector">2. PICK A STARTING POPULATION VECTOR</h2>
<p>this is the # of individuals in each class/stage at the start of your model. you should play around with this to see how it effects the outcome. My model is insensitive to realistic changes in this vector. Here are the “options”, the number in each class observed annually</p>
<pre class="sourceCode r"><code class="sourceCode r">n_options &lt;-<span class="st"> </span><span class="kw">ddply</span>(andre, <span class="kw">c</span>(<span class="st">&quot;YEAR&quot;</span>), function(df) <span class="kw">return</span>(<span class="kw">table</span>(df$CLASS)))
n_options</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##    YEAR A1 A2 A3 A4 dead   J
## 1  1994  6  3  2  2    0  13
## 2  1995 31 17 13 11    5  81
## 3  1996 49 15 14  6   52  16
## 4  1997 36 19 10  4   30   2
## 5  1998 10 22 13 17    9   0
## 6  1999  8 16 24 11    3   0
## 7  2000  6 17 17  8   11   0
## 8  2001  1 11 16 14    6   0
## 9  2002 13 14  6  0    9   0
## 10 2003  4  8  6  0   14   1
## 11 2004  0  0  0  0   19   0
## 12 2011 22 23 12  6    0 173
## 13 2012  6  1  0  1  172  34</code></pre>
<p>picked starting population vector from 1995, the first year with 9 observed populations</p>
<pre class="sourceCode r"><code class="sourceCode r">n95 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">81</span>, <span class="dv">31</span>, <span class="dv">17</span>, <span class="dv">13</span>, <span class="dv">11</span>)
n =<span class="st"> </span>n95</code></pre>
<p>you can also see that I only have J class individuals for a subset of the years. Check your data for missing bits like this. Perhaps your collaborator is forgetting to tell you that they didn’t survey for new juveniles from 1996-2003. It happens!</p>
<h2 id="generate-a-transition-matrix">3. GENERATE A TRANSITION MATRIX</h2>
<p>this matrix links each individual to its fate in the next year/cycle/season this is why you need each individual to be “dead” for a year, but no longer. If your raw data is like mine and only taken on live plants, “dead” might be something you have to add. make columns for year2, fate, and seeds2 for the whole census</p>
<pre class="sourceCode r"><code class="sourceCode r">trans &lt;-<span class="st"> </span><span class="kw">subset</span>(<span class="kw">merge</span>(andre, andre, <span class="dt">by =</span> <span class="st">&quot;PLANT_UNQ&quot;</span>, <span class="dt">sort =</span> <span class="ot">FALSE</span>), YEAR.x ==<span class="st"> </span>
<span class="st">    </span>YEAR.y -<span class="st"> </span><span class="dv">1</span>)
<span class="kw">head2</span>(trans)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      PLANT_UNQ YEAR.x CLASS.x SEEDS.x YEAR.y CLASS.y SEEDS.y
## 3          A_1   1994      A1   71.75   1995      A2   258.3
## 8          A_1   1995      A2  258.30   1996    dead     0.0
## 13         A_3   1996      A1   71.75   1997      A2   258.3
## .            .      .       .       .      .       .       .
## 6117     9_317   2011       J   71.75   2012       J     0.0</code></pre>
<p>rename rows and columns to improve clarity (I use the names used by popbio, which are similar to Morris and Doak) I think I worked out somewhat painfully that you need these particular column names.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(trans) &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(trans)
<span class="kw">colnames</span>(trans)[<span class="dv">1</span>:<span class="dv">7</span>] &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;plant&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;stage&quot;</span>, <span class="st">&quot;seeds&quot;</span>, <span class="st">&quot;year2&quot;</span>, <span class="st">&quot;fate&quot;</span>, 
    <span class="st">&quot;seeds2&quot;</span>)
<span class="kw">head2</span>(trans)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     plant year stage  seeds year2 fate seeds2
## 1     A_1 1994    A1  71.75  1995   A2  258.3
## 2     A_1 1995    A2 258.30  1996 dead    0.0
## 3     A_3 1996    A1  71.75  1997   A2  258.3
## .       .    .     .      .     .    .      .
## 825 9_317 2011     J  71.75  2012    J    0.0</code></pre>
<p>add individual fertility estimates from the calculations above</p>
<pre class="sourceCode r"><code class="sourceCode r">seedlingtrans &lt;-<span class="st"> </span><span class="fl">0.00305</span>  <span class="co"># This is the rate at which a seed becomes a J individual (I estimated this elsewhere, see Appendix below)</span></code></pre>
<p>adding in the number of J individuals produced by each individual</p>
<pre class="sourceCode r"><code class="sourceCode r">trans$J &lt;-<span class="st"> </span>trans$seeds *<span class="st"> </span>seedlingtrans  <span class="co"># note that J is not an integer, which is totally fine, its a rate of J production</span>
<span class="kw">head2</span>(trans)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     plant year stage  seeds year2 fate seeds2      J
## 1     A_1 1994    A1  71.75  1995   A2  258.3 0.2188
## 2     A_1 1995    A2 258.30  1996 dead    0.0 0.7878
## 3     A_3 1996    A1  71.75  1997   A2  258.3 0.2188
## .       .    .     .      .     .    .      .      .
## 825 9_317 2011     J  71.75  2012    J    0.0 0.2188</code></pre>
<h2 id="generate-annual-matrices-the-simple-way-for-3-easy-years">4. GENERATE ANNUAL MATRICES — THE SIMPLE WAY for 3 easy years</h2>
<h3 id="name-stages">NAME STAGES</h3>
<pre class="sourceCode r"><code class="sourceCode r">stages &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J&quot;</span>, <span class="st">&quot;A1&quot;</span>, <span class="st">&quot;A2&quot;</span>, <span class="st">&quot;A3&quot;</span>, <span class="st">&quot;A4&quot;</span>)</code></pre>
<p>you must have a vector named stages in this way for your own clases or stages used in the “stage” vector of your data frame</p>
<h3 id="set-iterations">SET ITERATIONS</h3>
<pre class="sourceCode r"><code class="sourceCode r">it &lt;-<span class="st"> </span><span class="dv">100</span>  <span class="co"># set the number of time steps for a deterministic model</span></code></pre>
<p>Make a demographic projection matrix for each year like so: 1994</p>
<pre class="sourceCode r"><code class="sourceCode r">trans94 &lt;-<span class="st"> </span><span class="kw">subset</span>(trans, year ==<span class="st"> </span><span class="dv">1994</span>, <span class="kw">c</span>(plant, stage, fate, J))
(proj94 &lt;-<span class="st"> </span><span class="kw">projection.matrix</span>(trans94, stage, fate, J, <span class="dt">sort =</span> stages))  <span class="co">#this gives you a projection matrix for 1994</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     
##            J     A1     A2     A3    A4
##   J  0.07692 0.1459 0.7878 0.7878 4.355
##   A1 0.53846 0.3333 0.3333 0.0000 0.000
##   A2 0.07692 0.3333 0.0000 0.0000 0.000
##   A3 0.00000 0.1667 0.3333 0.5000 0.000
##   A4 0.00000 0.0000 0.3333 0.5000 1.000</code></pre>
<p>you can do a simple deterministic projection of the matrix for just this year</p>
<pre class="sourceCode r"><code class="sourceCode r">(p94 &lt;-<span class="st"> </span><span class="kw">pop.projection</span>(proj94, n, it))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## $lambda
## [1] 1.496
## 
## $stable.stage
##       J      A1      A2      A3      A4 
## 0.48307 0.24671 0.07983 0.06803 0.12235 
## 
## $stage.vectors
##     0     1      2      3      4      5     6      7      8      9     10
## J  81 82.29 142.62 223.46 338.78 502.17 745.4 1112.5 1665.3 2493.0 3729.6
## A1 31 59.62  69.70 108.76 167.98 256.23 383.2  570.4  850.9 1272.2 1903.7
## A2 17 16.56  26.20  34.21  53.44  82.05 124.0  185.1  275.7  411.7  615.8
## A3 13 17.33  24.12  32.41  45.74  68.68 104.4  157.4  235.5  351.4  525.0
## A4 11 23.17  37.35  58.15  85.76 126.44 188.1  281.7  422.1  631.7  944.7
##        11   12    13    14    15    16    17    18     19     20     21
## J  5577.3 8340 12472 18653 27896 41720 62394 93313 139553 208707 312129
## A1 2848.1 4260  6370  9526 14247 21307 31865 47656  71271 106588 159407
## A2  921.5 1378  2061  3083  4610  6895 10311 15421  23063  34492  51584
## A3  785.1 1174  1757  2627  3929  5876  8787 13142  19654  29393  43959
## A4 1412.4 2112  3159  4724  7065 10567 15803 23633  35345  52859  79053
##        22     23      24      25      26      27      28      29       30
## J  466801 698120 1044066 1561441 2335197 3492380 5222992 7811190 11681943
## A1 238400 356536  533214  797443 1192607 1783591 2667431 3989249  5966079
## A2  77146 115374  172547  258051  385925  577166  863175 1290912  1930610
## A3  65742  98319  147041  219905  328877  491848  735578 1100086  1645222
## A4 118227 176813  264431  395467  591436  884516 1322829 1978343  2958690
##          31       32       33       34       35        36        37
## J  17470807 26128282 39075876 58439515 87398601 130708056 195479056
## A1  8922507 13343961 19956421 29845615 44635295  66753845  99833010
## A2  2887304  4318077  6457855  9657977 14443886  21601401  32305748
## A3  2460494  3679766  5503236  8230306 12308748  18408218  27530217
## A4  4424838  6617520  9896762 14800999 22135477  33104480  49509056
##           38        39        40        41        42        43        44
## J  292346643 437215941 653873694 977893912 1.462e+09 2.187e+09 3.271e+09
## A1 149304206 223290332 333939503 499419705 7.469e+08 1.117e+09 1.671e+09
## A2  48314520  72256272 108062106 161611144 2.417e+08 3.615e+08 5.406e+08
## A3  41172526  61575137  92088048 137721310 2.060e+08 3.080e+08 4.607e+08
## A4  74042747 110733850 165606843 247671569 3.704e+08 5.540e+08 8.285e+08
##           45        46        47        48        49        50        51
## J  4.892e+09 7.316e+09 1.094e+10 1.636e+10 2.447e+10 3.660e+10 5.474e+10
## A1 2.498e+09 3.736e+09 5.588e+09 8.357e+09 1.250e+10 1.869e+10 2.795e+10
## A2 8.085e+08 1.209e+09 1.808e+09 2.704e+09 4.044e+09 6.049e+09 9.046e+09
## A3 6.890e+08 1.030e+09 1.541e+09 2.305e+09 3.447e+09 5.154e+09 7.709e+09
## A4 1.239e+09 1.853e+09 2.771e+09 4.144e+09 6.198e+09 9.270e+09 1.386e+10
##           52        53        54        55        56        57        58
## J  8.186e+10 1.224e+11 1.831e+11 2.738e+11 4.095e+11 6.124e+11 9.159e+11
## A1 4.181e+10 6.252e+10 9.351e+10 1.398e+11 2.091e+11 3.128e+11 4.678e+11
## A2 1.353e+10 2.023e+10 3.026e+10 4.525e+10 6.768e+10 1.012e+11 1.514e+11
## A3 1.153e+10 1.724e+10 2.579e+10 3.856e+10 5.767e+10 8.625e+10 1.290e+11
## A4 2.073e+10 3.101e+10 4.637e+10 6.935e+10 1.037e+11 1.551e+11 2.320e+11
##           59        60        61        62        63        64        65
## J  1.370e+12 2.049e+12 3.064e+12 4.582e+12 6.852e+12 1.025e+13 1.533e+13
## A1 6.996e+11 1.046e+12 1.565e+12 2.340e+12 3.500e+12 5.234e+12 7.827e+12
## A2 2.264e+11 3.386e+11 5.063e+11 7.572e+11 1.132e+12 1.694e+12 2.533e+12
## A3 1.929e+11 2.885e+11 4.315e+11 6.453e+11 9.651e+11 1.443e+12 2.158e+12
## A4 3.469e+11 5.188e+11 7.759e+11 1.160e+12 1.736e+12 2.596e+12 3.882e+12
##           66        67        68        69        70        71        72
## J  2.292e+13 3.428e+13 5.127e+13 7.667e+13 1.147e+14 1.715e+14 2.565e+14
## A1 1.171e+13 1.751e+13 2.618e+13 3.916e+13 5.856e+13 8.758e+13 1.310e+14
## A2 3.788e+12 5.665e+12 8.473e+12 1.267e+13 1.895e+13 2.834e+13 4.238e+13
## A3 3.228e+12 4.828e+12 7.220e+12 1.080e+13 1.615e+13 2.415e+13 3.612e+13
## A4 5.805e+12 8.682e+12 1.298e+13 1.942e+13 2.904e+13 4.343e+13 6.495e+13
##           73        74        75        76        77        78        79
## J  3.836e+14 5.736e+14 8.579e+14 1.283e+15 1.919e+15 2.870e+15 4.292e+15
## A1 1.959e+14 2.930e+14 4.381e+14 6.552e+14 9.799e+14 1.466e+15 2.192e+15
## A2 6.339e+13 9.480e+13 1.418e+14 2.120e+14 3.171e+14 4.742e+14 7.092e+14
## A3 5.402e+13 8.079e+13 1.208e+14 1.807e+14 2.702e+14 4.041e+14 6.044e+14
## A4 9.714e+13 1.453e+14 2.173e+14 3.249e+14 4.860e+14 7.268e+14 1.087e+15
##           80        81        82        83        84        85        86
## J  6.418e+15 9.599e+15 1.436e+16 2.147e+16 3.211e+16 4.802e+16 7.181e+16
## A1 3.278e+15 4.902e+15 7.331e+15 1.096e+16 1.640e+16 2.452e+16 3.668e+16
## A2 1.061e+15 1.586e+15 2.372e+15 3.548e+15 5.306e+15 7.936e+15 1.187e+16
## A3 9.039e+14 1.352e+15 2.022e+15 3.024e+15 4.522e+15 6.763e+15 1.011e+16
## A4 1.626e+15 2.431e+15 3.636e+15 5.437e+15 8.132e+15 1.216e+16 1.819e+16
##           87        88        89        90        91        92        93
## J  1.074e+17 1.606e+17 2.402e+17 3.592e+17 5.373e+17 8.035e+17 1.202e+18
## A1 5.485e+16 8.203e+16 1.227e+17 1.835e+17 2.744e+17 4.104e+17 6.137e+17
## A2 1.775e+16 2.654e+16 3.970e+16 5.937e+16 8.879e+16 1.328e+17 1.986e+17
## A3 1.513e+16 2.262e+16 3.383e+16 5.059e+16 7.566e+16 1.132e+17 1.692e+17
## A4 2.720e+16 4.068e+16 6.084e+16 9.099e+16 1.361e+17 2.035e+17 3.043e+17
##           94        95        96        97        98        99
## J  1.797e+18 2.688e+18 4.020e+18 6.011e+18 8.990e+18 1.345e+19
## A1 9.178e+17 1.373e+18 2.053e+18 3.070e+18 4.591e+18 6.867e+18
## A2 2.970e+17 4.442e+17 6.643e+17 9.935e+17 1.486e+18 2.222e+18
## A3 2.531e+17 3.785e+17 5.661e+17 8.466e+17 1.266e+18 1.894e+18
## A4 4.552e+17 6.807e+17 1.018e+18 1.522e+18 2.277e+18 3.405e+18
## 
## $pop.sizes
##   [1] 1.530e+02 1.990e+02 3.000e+02 4.570e+02 6.917e+02 1.036e+03 1.545e+03
##   [8] 2.307e+03 3.449e+03 5.160e+03 7.719e+03 1.154e+04 1.726e+04 2.582e+04
##  [15] 3.861e+04 5.775e+04 8.636e+04 1.292e+05 1.932e+05 2.889e+05 4.320e+05
##  [22] 6.461e+05 9.663e+05 1.445e+06 2.161e+06 3.232e+06 4.834e+06 7.230e+06
##  [29] 1.081e+07 1.617e+07 2.418e+07 3.617e+07 5.409e+07 8.089e+07 1.210e+08
##  [36] 1.809e+08 2.706e+08 4.047e+08 6.052e+08 9.051e+08 1.354e+09 2.024e+09
##  [43] 3.027e+09 4.528e+09 6.771e+09 1.013e+10 1.514e+10 2.265e+10 3.387e+10
##  [50] 5.066e+10 7.576e+10 1.133e+11 1.695e+11 2.534e+11 3.790e+11 5.668e+11
##  [57] 8.477e+11 1.268e+12 1.896e+12 2.836e+12 4.241e+12 6.342e+12 9.485e+12
##  [64] 1.419e+13 2.121e+13 3.173e+13 4.745e+13 7.096e+13 1.061e+14 1.587e+14
##  [71] 2.374e+14 3.550e+14 5.309e+14 7.940e+14 1.187e+15 1.776e+15 2.656e+15
##  [78] 3.972e+15 5.940e+15 8.884e+15 1.329e+16 1.987e+16 2.972e+16 4.444e+16
##  [85] 6.646e+16 9.940e+16 1.487e+17 2.223e+17 3.325e+17 4.973e+17 7.437e+17
##  [92] 1.112e+18 1.663e+18 2.488e+18 3.720e+18 5.564e+18 8.321e+18 1.244e+19
##  [99] 1.861e+19 2.783e+19
## 
## $pop.changes
##  [1] 1.300 1.508 1.523 1.514 1.497 1.492 1.493 1.495 1.496 1.496 1.496
## [12] 1.495 1.495 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496
## [23] 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496
## [34] 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496
## [45] 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496
## [56] 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496
## [67] 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496
## [78] 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496
## [89] 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496 1.496</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(l94 &lt;-<span class="st"> </span>p94$lambda)  <span class="co"># wow! if we looked only at 1994 based on these estimates the population would be booming!</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 1.496</code></pre>
<p>stable.stage shows the proportion of the population in each stage class at the mythical equilibrium, 48% of plants are juveniles in 100 years note that the population has gone from around 200 individuals in 1994 to 2.8e+19 in 100 years, nice!</p>
<p>Now make some matrices for other years 1995</p>
<pre class="sourceCode r"><code class="sourceCode r">trans95 &lt;-<span class="st"> </span><span class="kw">subset</span>(trans, year ==<span class="st"> </span><span class="dv">1995</span>, <span class="kw">c</span>(plant, stage, fate, J))
(proj95 &lt;-<span class="st"> </span><span class="kw">projection.matrix</span>(trans95, stage, fate, J, <span class="dt">sort =</span> stages))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     
##           J     A1     A2      A3      A4
##   J  0.2000 0.2626 1.0298 3.52160 6.21499
##   A1 0.2125 0.7419 0.4706 0.07692 0.00000
##   A2 0.0000 0.1290 0.4706 0.15385 0.09091
##   A3 0.0000 0.0000 0.0000 0.76923 0.36364
##   A4 0.0000 0.0000 0.0000 0.00000 0.54545</code></pre>
<p>2011</p>
<pre class="sourceCode r"><code class="sourceCode r">trans11 &lt;-<span class="st"> </span><span class="kw">subset</span>(trans, year ==<span class="st"> </span><span class="dv">2011</span>, <span class="kw">c</span>(plant, stage, fate, J))
(proj11 &lt;-<span class="st"> </span><span class="kw">projection.matrix</span>(trans11, stage, fate, J, <span class="dt">sort =</span> stages))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     
##           J      A1     A2     A3    A4
##   J  0.1573 0.98329 4.5710 8.0648 7.922
##   A1 0.0000 0.05556 0.3077 0.1429 0.000
##   A2 0.0000 0.00000 0.0000 0.0000 0.500
##   A3 0.0000 0.00000 0.0000 0.0000 0.000
##   A4 0.0000 0.00000 0.0000 0.1429 0.000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
p95 &lt;-<span class="st"> </span><span class="kw">pop.projection</span>(proj95, n, it)
(l95 &lt;-<span class="st"> </span>p95$lambda)  <span class="co"># lambda is much lower in 1995</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 0.9954</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
(p11 &lt;-<span class="st"> </span><span class="kw">pop.projection</span>(proj11, n, pi))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## $lambda
## [1] 0.3065
## 
## $stable.stage
##        J       A1       A2       A3       A4 
## 0.969161 0.021632 0.009207 0.000000 0.000000 
## 
## $stage.vectors
##     0       1       2
## J  81 312.916 97.7480
## A1 31   8.810  2.1818
## A2 17   5.500  0.9286
## A3 13   0.000  0.0000
## A4 11   1.857  0.0000
## 
## $pop.sizes
## [1] 153.0 329.1 100.9
## 
## $pop.changes
## [1] 2.1509 0.3065</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(l11 &lt;-<span class="st"> </span>p11$lambda)  <span class="co"># and based on 2011 alone extinction is eminent. The gist here is we need lots of years of data to make any decent estimation</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 0.3065</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># of what the population is really likely to do (ie more than the three</span>
<span class="co"># here)</span></code></pre>
<h2 id="deterministic-analaysis-of-these-3-well-behaved-years---basic-non-stochastic-pva">5. DETERMINISTIC ANALAYSIS OF THESE 3 WELL BEHAVED YEARS - basic non-stochastic PVA</h2>
<pre class="sourceCode r"><code class="sourceCode r">thesearethemeanprojmats &lt;-<span class="st"> </span><span class="kw">list</span>(proj94, proj95, proj11)  <span class="co"># make a list of the three matrices</span>
(meanxprojmat &lt;-<span class="st"> </span><span class="kw">mean</span>(thesearethemeanprojmats))  <span class="co"># make a mean of the three projection matrices for deterministic analysis</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     
##            J      A1     A2      A3     A4
##   J  0.14475 0.46393 2.1295 4.12473 6.1639
##   A1 0.25032 0.37694 0.3705 0.07326 0.0000
##   A2 0.02564 0.15412 0.1569 0.05128 0.1970
##   A3 0.00000 0.05556 0.1111 0.42308 0.1212
##   A4 0.00000 0.00000 0.1111 0.21429 0.5152</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
n  <span class="co"># recall what n is, our starting population vector, ie the # of individuals in each class at the start of the projection</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 81 31 17 13 11</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(pprojme &lt;-<span class="st"> </span><span class="kw">pop.projection</span>(meanxprojmat, n))  <span class="co"># do the deterministic projection, lambda is the dominant left eigenvalue</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## $lambda
## [1] 1.089
## 
## $stable.stage
##       J      A1      A2      A3      A4 
## 0.61436 0.25469 0.06677 0.03730 0.02688 
## 
## $stage.vectors
##     0      1       2       3       4       5      6      7      8      9
## J  81 183.73 177.921 182.074 196.519 214.113 233.26 253.98 276.50 301.01
## A1 31  39.21  66.116  75.791  82.085  88.980  96.75 105.30 114.63 124.79
## A2 17  12.35  15.265  19.380  21.551  23.374  25.38  27.61  30.05  32.71
## A3 13  10.44   9.224  10.355  11.748  12.972  14.16  15.42  16.79  18.28
## A4 11  10.34   8.938   8.277   8.636   9.361  10.20  11.11  12.10  13.17
##        10     11     12     13     14     15     16     17     18     19
## J  327.68 356.72 388.33 422.74 460.21 500.99 545.38 593.72 646.33 703.61
## A1 135.85 147.88 160.99 175.26 190.79 207.69 226.10 246.14 267.95 291.69
## A2  35.61  38.77  42.20  45.94  50.02  54.45  59.27  64.53  70.24  76.47
## A3  19.90  21.66  23.58  25.67  27.94  30.42  33.11  36.05  39.24  42.72
## A4  14.33  15.60  16.99  18.49  20.13  21.92  23.86  25.97  28.27  30.78
## 
## $pop.sizes
##  [1]  153.0  256.1  277.5  295.9  320.5  348.8  379.7  413.4  450.1  490.0
## [11]  533.4  580.6  632.1  688.1  749.1  815.5  887.7  966.4 1052.0 1145.3
## 
## $pop.changes
##  [1] 1.674 1.083 1.066 1.083 1.088 1.089 1.089 1.089 1.089 1.089 1.089
## [12] 1.089 1.089 1.089 1.089 1.089 1.089 1.089 1.089</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(DetLamb &lt;-<span class="st"> </span>pprojme$lambda)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 1.089</code></pre>
<h2 id="run-stochastic-analyses-on-these-3-well-behaved-years">6. RUN STOCHASTIC ANALYSES ON THESE 3 WELL BEHAVED YEARS</h2>
<p>For a stochastic analysis, include all of the annual matrices, then make a random draw with replacement</p>
<p>For a series of time step, or until stable stage distribution is reached.</p>
<pre class="sourceCode r"><code class="sourceCode r">thesearethemeanprojmats  <span class="co"># our list of projection matrices</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [[1]]
##     
##            J     A1     A2     A3    A4
##   J  0.07692 0.1459 0.7878 0.7878 4.355
##   A1 0.53846 0.3333 0.3333 0.0000 0.000
##   A2 0.07692 0.3333 0.0000 0.0000 0.000
##   A3 0.00000 0.1667 0.3333 0.5000 0.000
##   A4 0.00000 0.0000 0.3333 0.5000 1.000
## 
## [[2]]
##     
##           J     A1     A2      A3      A4
##   J  0.2000 0.2626 1.0298 3.52160 6.21499
##   A1 0.2125 0.7419 0.4706 0.07692 0.00000
##   A2 0.0000 0.1290 0.4706 0.15385 0.09091
##   A3 0.0000 0.0000 0.0000 0.76923 0.36364
##   A4 0.0000 0.0000 0.0000 0.00000 0.54545
## 
## [[3]]
##     
##           J      A1     A2     A3    A4
##   J  0.1573 0.98329 4.5710 8.0648 7.922
##   A1 0.0000 0.05556 0.3077 0.1429 0.000
##   A2 0.0000 0.00000 0.0000 0.0000 0.500
##   A3 0.0000 0.00000 0.0000 0.0000 0.000
##   A4 0.0000 0.00000 0.0000 0.1429 0.000</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
stochme &lt;-<span class="st"> </span><span class="kw">stoch.growth.rate</span>(thesearethemeanprojmats, <span class="dt">prob =</span> <span class="ot">NULL</span>, <span class="dt">maxt =</span> <span class="dv">50000</span>, 
    <span class="dt">verbose =</span> <span class="ot">TRUE</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] Calculating stochastic growth at time 1
## [1] Calculating stochastic growth at time 10000
## [1] Calculating stochastic growth at time 20000
## [1] Calculating stochastic growth at time 30000
## [1] Calculating stochastic growth at time 40000
## [1] Calculating stochastic growth at time 50000</code></pre>
<p>note that these stochastic approximations of lambda are in log form (not immediately comparable to pop.project$lambda)</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(stochme$approx)  <span class="co"># is the analytic approximation of lambda via Tuljapakar&#39;s method</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 0.946</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">stochme$approx  <span class="co"># this is more accurate (perhaps) when there is a lot of covariation in matrix elements</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] -0.05556</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">exp</span>(stochme$sim)  <span class="co"># gives stochastic growth rate by simulation, random draws of whole</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 0.8884</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">stochme$sim</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] -0.1183</code></pre>
<p>Tuljapurkar’s approximation takes into account how stochastic variation in the matrix elements affects the long-term stochastic growth rate (Caswell 2001). It can be more accurate in cases where there is covariation between matrix elements within the same year but may not be as accurate when there is a high level of temporal variation (Morris and Doak 2002, Stubben et al. 2012).</p>
<h3 id="fun-with-stochastic-analyses">Fun with stochastic analyses!</h3>
<p>Its easy to give years “weights” in the stochastic model. For example, you can increase the drought rate by weighting drought years (2011)</p>
<pre class="sourceCode r"><code class="sourceCode r">yearweight &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>)
moredrought &lt;-<span class="st"> </span><span class="kw">stoch.projection</span>(thesearethemeanprojmats, n, <span class="dt">tmax =</span> <span class="dv">50</span>, <span class="dt">prob =</span> yearweight, 
    <span class="dt">nreps =</span> <span class="dv">500</span>)</code></pre>
<p>the output is population sizes, which are fun to graph when comparing models</p>
<pre class="sourceCode r"><code class="sourceCode r">yearweight &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>)
nodrought &lt;-<span class="st"> </span><span class="kw">stoch.projection</span>(thesearethemeanprojmats, n, <span class="dt">tmax =</span> <span class="dv">50</span>, <span class="dt">prob =</span> yearweight, 
    <span class="dt">nreps =</span> <span class="dv">500</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">hist</span>(<span class="kw">log</span>(<span class="kw">apply</span>(moredrought, <span class="dv">1</span>, sum)), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">density =</span> <span class="dv">50</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, 
    <span class="dv">150</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="fl">1.3</span>, <span class="dv">25</span>), <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;More drought&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">log10</span>(<span class="dv">200</span>), <span class="dt">lty =</span> <span class="dv">3</span>)  <span class="co"># puts a line at the starting population size for reference</span>
<span class="kw">hist</span>(<span class="kw">log</span>(<span class="kw">apply</span>(nodrought, <span class="dv">1</span>, sum)), <span class="dt">col =</span> <span class="st">&quot;green3&quot;</span>, <span class="dt">density =</span> <span class="dv">50</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, 
    <span class="dv">150</span>), <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="fl">1.3</span>, <span class="dv">25</span>), <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;No drought&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">log10</span>(<span class="dv">200</span>), <span class="dt">lty =</span> <span class="dv">3</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-21.png" />
</div>
<p>you can get fancy and put these on the same graph too to compare outcomes. y axis is frequency of final population size at tmax.</p>
<h2 id="quasi-extinction-based-on-these-3-well-behaved-years">7. QUASI EXTINCTION BASED ON THESE 3 WELL BEHAVED YEARS</h2>
<p>Another useful way to think about populations. Since our ability to really estimate lambda is based on the assumption of equilibrium at stable stage, it might be more realistic to think about comparing extinction probabilities for different scenarios that comparing lambdas. these are based on stochastic runs</p>
<pre class="sourceCode r"><code class="sourceCode r">
obsd &lt;-<span class="st"> </span><span class="kw">stoch.quasi.ext</span>(thesearethemeanprojmats, n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">Nx =</span> <span class="dv">10</span>, 
    <span class="dt">tmax =</span> <span class="dv">50</span>, <span class="dt">maxruns =</span> <span class="dv">10</span>, <span class="dt">nreps =</span> <span class="dv">500</span>, <span class="dt">sumweight =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

drt &lt;-<span class="st"> </span><span class="kw">stoch.quasi.ext</span>(thesearethemeanprojmats, n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">Nx =</span> <span class="dv">10</span>, 
    <span class="dt">tmax =</span> <span class="dv">50</span>, <span class="dt">maxruns =</span> <span class="dv">10</span>, <span class="dt">nreps =</span> <span class="dv">500</span>, <span class="dt">sumweight =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">verbose =</span> <span class="ot">FALSE</span>)

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
<span class="kw">matplot</span>(obsd, <span class="dt">ylab =</span> <span class="st">&quot;Quasi-extinction probability&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, 
    <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rainbow</span>(<span class="dv">10</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Observed climate&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Years&quot;</span>)
<span class="kw">matplot</span>(drt, <span class="dt">ylab =</span> <span class="st">&quot;Quasi-extinction probability&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">1.1</span>), <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, 
    <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">rainbow</span>(<span class="dv">10</span>), <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">main =</span> <span class="st">&quot;Double drought&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Years&quot;</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-22.png" />
</div>
<h2 id="sensitivity-and-elasticity">8. SENSITIVITY AND ELASTICITY</h2>
<p>SENSITIVITY is a measure of the amount of change is lambda give a small change in a matrix element.</p>
<p>ELASTICITY is a measure of ``proportional’’ effect, i.e., the effect that a change in a given matrix element has as a proportional to the change in that element</p>
<pre class="sourceCode r"><code class="sourceCode r">meanxprojmat</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     
##            J      A1     A2      A3     A4
##   J  0.14475 0.46393 2.1295 4.12473 6.1639
##   A1 0.25032 0.37694 0.3705 0.07326 0.0000
##   A2 0.02564 0.15412 0.1569 0.05128 0.1970
##   A3 0.00000 0.05556 0.1111 0.42308 0.1212
##   A4 0.00000 0.00000 0.1111 0.21429 0.5152</code></pre>
<p>for an overall look at sensitivity and elasticity use the mean projection matrix you could do separate analyses by year or type of year too to examine how sensitivity and elasticity vary among years</p>
<pre class="sourceCode r"><code class="sourceCode r">(eigout &lt;-<span class="st"> </span><span class="kw">eigen.analysis</span>(meanxprojmat))  <span class="co"># do the associated sensitivity analysis</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## $lambda1
## [1] 1.089
## 
## $stable.stage
##       J      A1      A2      A3      A4 
## 0.61436 0.25469 0.06677 0.03730 0.02688 
## 
## $sensitivities
##     
##           J      A1      A2      A3       A4
##   J  0.2255 0.09351 0.02451 0.01369 0.009867
##   A1 0.6930 0.28729 0.07532 0.04208 0.000000
##   A2 1.5373 0.63734 0.16708 0.09334 0.067253
##   A3 0.0000 1.13131 0.29658 0.16569 0.119377
##   A4 0.0000 0.00000 0.38356 0.21428 0.154386
## 
## $elasticities
##     
##            J      A1      A2       A3      A4
##   J  0.02999 0.03985 0.04795 0.051889 0.05587
##   A1 0.15935 0.09948 0.02564 0.002832 0.00000
##   A2 0.03621 0.09023 0.02408 0.004397 0.01217
##   A3 0.00000 0.05773 0.03027 0.064394 0.01329
##   A4 0.00000 0.00000 0.03915 0.042180 0.07306
## 
## $repro.value
##      J     A1     A2     A3     A4 
##  1.000  3.072  6.816 12.099 15.647 
## 
## $damping.ratio
## [1] 4.215</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">colSums</span>(eigout$sensitivities)  <span class="co"># this gives the cumulative sensitivity of each stage/class, fun to graph</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      J     A1     A2     A3     A4 
## 2.4559 2.1494 0.9471 0.5291 0.3509</code></pre>
<p>calculate fertility and survival sums</p>
<pre class="sourceCode r"><code class="sourceCode r">(projsums &lt;-<span class="st"> </span><span class="kw">colSums</span>(meanxprojmat))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      J     A1     A2     A3     A4 
## 0.4207 1.0505 2.8792 4.8866 6.9973</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(fert_row &lt;-<span class="st"> </span>meanxprojmat[<span class="dv">1</span>, ])</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      J     A1     A2     A3     A4 
## 0.1448 0.4639 2.1295 4.1247 6.1639</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(surv_row &lt;-<span class="st"> </span>projsums -<span class="st"> </span>fert_row)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      J     A1     A2     A3     A4 
## 0.2760 0.5866 0.7496 0.7619 0.8333</code></pre>
<p>can do this for sens and elas too to make a bar chart</p>
<p>make x where columes are name, sens and elas</p>
<p>for my data I’m summing elasticity and sensitivity for each class. You could also pick the vital rates that are most meaningful in your own analysis</p>
<pre class="sourceCode r"><code class="sourceCode r">(eigout &lt;-<span class="st"> </span><span class="kw">eigen.analysis</span>(meanxprojmat))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## $lambda1
## [1] 1.089
## 
## $stable.stage
##       J      A1      A2      A3      A4 
## 0.61436 0.25469 0.06677 0.03730 0.02688 
## 
## $sensitivities
##     
##           J      A1      A2      A3       A4
##   J  0.2255 0.09351 0.02451 0.01369 0.009867
##   A1 0.6930 0.28729 0.07532 0.04208 0.000000
##   A2 1.5373 0.63734 0.16708 0.09334 0.067253
##   A3 0.0000 1.13131 0.29658 0.16569 0.119377
##   A4 0.0000 0.00000 0.38356 0.21428 0.154386
## 
## $elasticities
##     
##            J      A1      A2       A3      A4
##   J  0.02999 0.03985 0.04795 0.051889 0.05587
##   A1 0.15935 0.09948 0.02564 0.002832 0.00000
##   A2 0.03621 0.09023 0.02408 0.004397 0.01217
##   A3 0.00000 0.05773 0.03027 0.064394 0.01329
##   A4 0.00000 0.00000 0.03915 0.042180 0.07306
## 
## $repro.value
##      J     A1     A2     A3     A4 
##  1.000  3.072  6.816 12.099 15.647 
## 
## $damping.ratio
## [1] 4.215</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">eigout$sensitivities</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##     
##           J      A1      A2      A3       A4
##   J  0.2255 0.09351 0.02451 0.01369 0.009867
##   A1 0.6930 0.28729 0.07532 0.04208 0.000000
##   A2 1.5373 0.63734 0.16708 0.09334 0.067253
##   A3 0.0000 1.13131 0.29658 0.16569 0.119377
##   A4 0.0000 0.00000 0.38356 0.21428 0.154386</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
(fert_row_s &lt;-<span class="st"> </span>eigout$sensitivities[<span class="dv">1</span>, ])</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##        J       A1       A2       A3       A4 
## 0.225549 0.093506 0.024513 0.013695 0.009867</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(surv_row_s &lt;-<span class="st"> </span>eigout$sensitivities[<span class="dv">2</span>, ] +<span class="st"> </span>eigout$sensitivities[<span class="dv">3</span>, ] +<span class="st"> </span>eigout$sensitivities[<span class="dv">4</span>, 
    ] +<span class="st"> </span>eigout$sensitivities[<span class="dv">5</span>, ])</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      J     A1     A2     A3     A4 
## 2.2303 2.0559 0.9225 0.5154 0.3410</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sensme &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">cbind</span>(fert_row_s, surv_row_s))


(fert_row_e &lt;-<span class="st"> </span>eigout$elasticities[<span class="dv">1</span>, ])</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##       J      A1      A2      A3      A4 
## 0.02999 0.03985 0.04795 0.05189 0.05587</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(surv_row_e &lt;-<span class="st"> </span>eigout$elasticities[<span class="dv">2</span>, ] +<span class="st"> </span>eigout$elasticities[<span class="dv">3</span>, ] +<span class="st"> </span>eigout$elasticities[<span class="dv">4</span>, 
    ] +<span class="st"> </span>eigout$elasticities[<span class="dv">5</span>, ])</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##       J      A1      A2      A3      A4 
## 0.19556 0.24744 0.11913 0.11380 0.09852</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(survtable &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">rbind</span>(surv_row_s, surv_row_e)))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##    surv_row_s surv_row_e
## J      2.2303    0.19556
## A1     2.0559    0.24744
## A2     0.9225    0.11913
## A3     0.5154    0.11380
## A4     0.3410    0.09852</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">(ferttable &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">rbind</span>(fert_row_s, fert_row_e)))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##    fert_row_s fert_row_e
## J    0.225549    0.02999
## A1   0.093506    0.03985
## A2   0.024513    0.04795
## A3   0.013695    0.05189
## A4   0.009867    0.05587</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">
<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
mynames &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Sensitivity&quot;</span>, <span class="st">&quot;Elasticity&quot;</span>)
<span class="kw">barplot</span>(<span class="kw">t</span>(survtable[, <span class="dv">1</span>:<span class="dv">2</span>]), <span class="dt">beside =</span> <span class="ot">TRUE</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">3.5</span>), <span class="dt">xlab =</span> <span class="st">&quot;Stage class&quot;</span>, 
    <span class="dt">main =</span> <span class="st">&quot;Growth and survival&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">barplot</span>(<span class="kw">t</span>(ferttable[, <span class="dv">1</span>:<span class="dv">2</span>]), <span class="dt">beside =</span> <span class="ot">TRUE</span>, <span class="dt">las =</span> <span class="dv">1</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="dt">xlab =</span> <span class="st">&quot;Stage class&quot;</span>, 
    <span class="dt">main =</span> <span class="st">&quot;Fertility&quot;</span>)
<span class="kw">abline</span>(<span class="dt">h =</span> <span class="dv">0</span>)
<span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, mynames, <span class="dt">fill =</span> <span class="kw">grey.colors</span>(<span class="dv">2</span>))</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/unnamed-chunk-25.png" />
</div>
<h2 id="appendix-a.-how-i-generated-a-fecundity-estimate">APPENDIX A. HOW I GENERATED A FECUNDITY ESTIMATE</h2>
<p>I’m including this for plant folks who might like to see how I made fecundity estimates from real data I also have developed a script to simulate juvenile numbers and transition rates for the years in my dataset that are missing these data, and bootstraps of the whole model.</p>
<p>Load up the raw-ish data</p>
<pre class="sourceCode r"><code class="sourceCode r">andre &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;D__composite9_13_2012.csv&quot;</span>)
<span class="kw">str</span>(andre)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## &#39;data.frame&#39;:    1693 obs. of  15 variables:
##  $ PLANT_UNQ   : Factor w/ 619 levels &quot;1_701&quot;,&quot;1_702&quot;,..: 462 464 473 477 482 487 474 479 483 463 ...
##  $ YEAR        : int  1994 1994 1994 1994 1994 1994 1994 1994 1994 1994 ...
##  $ CLASS       : Factor w/ 6 levels &quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,..: 1 1 1 1 1 1 2 2 2 3 ...
##  $ OBS_ID      : int  1 3 20 24 11 16 21 26 12 2 ...
##  $ COHORT      : Factor w/ 18 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 10 10 11 11 11 11 11 11 11 10 ...
##  $ PLANT.NUM   : Factor w/ 460 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 23 5 9 41 168 6 11 42 12 ...
##  $ xDIAM_cm    : num  12 11 17 12 18 12 23 22 29 32 ...
##  $ SEEDS_DC    : num  26.7 26.7 26.7 26.7 26.7 ...
##  $ MEDIAN_INFL : int  5 0 5 0 5 5 18 18 18 18 ...
##  $ INFL_CLASS  : int  1 0 1 0 1 1 2 2 2 2 ...
##  $ MAX_INFL    : int  111 0 111 0 111 111 123 123 123 123 ...
##  $ OBS_INLF    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEDS_YR_INF: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ CAGED       : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ WATERED     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
<p>BEST ESTIMATE OF SEED PRODUCTION: average of seeds/fruit, weighed average of fruits/infl where 0.14 is 1/8 drought years</p>
<pre class="sourceCode r"><code class="sourceCode r">andre$SEEDS &lt;-<span class="st"> </span>andre$MEDIAN_INFL *<span class="st"> </span><span class="fl">14.35</span>  <span class="co"># = 14.35 seeds/infl</span></code></pre>
<p>The big crux Part 2: How many seeds makes a J plant the next year? ie what is the transition rate or fecundity rate? observed juveniles in each year (sadly not all years have the same # of cohorts, so I adjust for that below)</p>
<pre class="sourceCode r"><code class="sourceCode r">seedling_yr &lt;-<span class="st"> </span><span class="kw">ddply</span>(andre, <span class="kw">c</span>(<span class="st">&quot;YEAR&quot;</span>), function(df) <span class="kw">return</span>(<span class="kw">c</span>(<span class="dt">sdlgs =</span> <span class="kw">sum</span>(df$CLASS ==<span class="st"> </span>
<span class="st">    &quot;J&quot;</span>))))  <span class="co"># shows the OBSERVED # of J plants each year,</span></code></pre>
<p>and some of these are not observation years and are omitted below</p>
<pre class="sourceCode r"><code class="sourceCode r">seedling_yr</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##    YEAR sdlgs
## 1  1994    13
## 2  1995    81
## 3  1996    16
## 4  1997     2
## 5  1998     0
## 6  1999     0
## 7  2000     0
## 8  2001     0
## 9  2002     0
## 10 2003     1
## 11 2004     0
## 12 2011   362
## 13 2012    57</code></pre>
<p>seedlings for 9 cohorts based on census from each year</p>
<pre class="sourceCode r"><code class="sourceCode r">sdl94 =<span class="st"> </span>seedling_yr$sdlgs[(seedling_yr$YEAR ==<span class="st"> &quot;1994&quot;</span>)] *<span class="st"> </span><span class="dv">9</span>/<span class="dv">2</span>  <span class="co"># this year had only 2 cohorts</span>
sdl95 =<span class="st"> </span>seedling_yr$sdlgs[(seedling_yr$YEAR ==<span class="st"> &quot;1995&quot;</span>)]
sdl11 =<span class="st"> </span>seedling_yr$sdlgs[(seedling_yr$YEAR ==<span class="st"> &quot;2011&quot;</span>)]
sdl12 =<span class="st"> </span><span class="dv">0</span>  <span class="co"># in 2012 observed seedlings were 0</span>

seedling_pick =<span class="st"> </span><span class="kw">c</span>(sdl94, sdl95, sdl11, sdl12)
seedling_pick</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1]  58.5  81.0 362.0   0.0</code></pre>
<p>estimate seedlings as the mean of the 4 OBSERVED years: in the other years seedlings where not surveyed for</p>
<pre class="sourceCode r"><code class="sourceCode r">(<span class="dt">seedlings =</span> <span class="kw">mean</span>(seedling_pick))  <span class="co"># = 125.375 seedlings/year on average</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 125.4</code></pre>
<p>what’s the annual total seed production rate? add up all the seeds estimated to be produced in each year</p>
<pre class="sourceCode r"><code class="sourceCode r">seed_yr &lt;-<span class="st"> </span><span class="kw">ddply</span>(andre, <span class="kw">c</span>(<span class="st">&quot;YEAR&quot;</span>), function(df) <span class="kw">return</span>(<span class="kw">c</span>(<span class="dt">sumseeds =</span> <span class="kw">sum</span>(df$SEEDS))))
seed_yr</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##    YEAR sumseeds
## 1  1994     4434
## 2  1995    45834
## 3  1996    13302
## 4  1997    15426
## 5  1998    51976
## 6  1999    45030
## 7  2000    18913
## 8  2001    45576
## 9  2002     2597
## 10 2003     6257
## 11 2004        0
## 12 2011   158065
## 13 2012     3071</code></pre>
<p>adjust so that 1994 has an estimate of all cohorts based on the observed 2 cohorts</p>
<pre class="sourceCode r"><code class="sourceCode r">seed_yr$sumseeds[(seedling_yr$YEAR ==<span class="st"> &quot;1994&quot;</span>)] &lt;-<span class="st"> </span>(seed_yr$sumseeds[(seedling_yr$YEAR ==<span class="st"> </span>
<span class="st">    &quot;1994&quot;</span>)] *<span class="st"> </span><span class="dv">9</span>/<span class="dv">2</span>)</code></pre>
<p>get mean seeds/year</p>
<pre class="sourceCode r"><code class="sourceCode r">avg_seeds_p_yr &lt;-<span class="st"> </span><span class="kw">mean</span>(seed_yr$sumseeds)</code></pre>
<p>for each of the 4 years in which seedlings were observed, calculate an estimate of the transition rate from seed –&gt; J</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(sdl.trans94 &lt;-<span class="st"> </span>sdl94/avg_seeds_p_yr)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##  num 0.00179</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(sdl.trans95 &lt;-<span class="st"> </span>sdl95/avg_seeds_p_yr)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##  num 0.00247</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(sdl.trans11 &lt;-<span class="st"> </span>sdl11/avg_seeds_p_yr)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##  num 0.011</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">sdl.trans12 &lt;-<span class="st"> </span><span class="dv">0</span>  <span class="co"># no seedlings observed this year</span></code></pre>
<p>looks at the options for transition rate</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(seedlingtrans_pick &lt;-<span class="st"> </span><span class="kw">c</span>(sdl.trans94, sdl.trans95, sdl.trans11, sdl.trans12))</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##  num [1:4] 0.00179 0.00247 0.01105 0</code></pre>
<p>pick the mean for this analysis</p>
<pre class="sourceCode r"><code class="sourceCode r">(seedlingtrans &lt;-<span class="st"> </span><span class="kw">mean</span>(seedlingtrans_pick))  <span class="co"># mean seedling transition rate  0.00305</span></code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## [1] 0.003826</code></pre>
<p>Now remove watered and caged plants from main dataset, these have different survival and transition rates. I included them thus far because we needed to get seed production estimates for them. Since they might have contributed to the observed juveniles</p>
<pre class="sourceCode r"><code class="sourceCode r">andre &lt;-<span class="st"> </span>andre[(andre$CAGED ==<span class="st"> &quot;N&quot;</span>), ]
andre &lt;-<span class="st"> </span>andre[(andre$WATERED ==<span class="st"> &quot;N&quot;</span>), ]
<span class="kw">head2</span>(andre)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      PLANT_UNQ YEAR CLASS OBS_ID COHORT PLANT.NUM xDIAM_cm SEEDS_DC
## 1          A_1 1994    A1      1      A         1     12.0     26.7
## 2          A_3 1994    A1      3      A         3     11.0     26.7
## 3         B_13 1994    A1     20      B        13     17.0     26.7
## .            .    .     .      .      .         .        .        .
## 1675    6_772A 2012     J    608      6      772A      4.7      0.0
##      MEDIAN_INFL INFL_CLASS MAX_INFL OBS_INLF SEEDS_YR_INF CAGED WATERED
## 1              5          1      111       NA           NA     N       N
## 2              0          0        0       NA           NA     N       N
## 3              5          1      111       NA           NA     N       N
## .              .          .        .        .            .     .       .
## 1675           0          0        0        0            0     N       N
##      SEEDS
## 1    71.75
## 2     0.00
## 3    71.75
## .        .
## 1675  0.00</code></pre>
<p>reduce datafile to include only PLANT_UNQ, YEAR, CLASS and SEEDS</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(andre)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## &#39;data.frame&#39;:    1221 obs. of  16 variables:
##  $ PLANT_UNQ   : Factor w/ 619 levels &quot;1_701&quot;,&quot;1_702&quot;,..: 462 464 473 477 482 487 474 479 483 463 ...
##  $ YEAR        : int  1994 1994 1994 1994 1994 1994 1994 1994 1994 1994 ...
##  $ CLASS       : Factor w/ 6 levels &quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,..: 1 1 1 1 1 1 2 2 2 3 ...
##  $ OBS_ID      : int  1 3 20 24 11 16 21 26 12 2 ...
##  $ COHORT      : Factor w/ 18 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,..: 10 10 11 11 11 11 11 11 11 10 ...
##  $ PLANT.NUM   : Factor w/ 460 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 1 23 5 9 41 168 6 11 42 12 ...
##  $ xDIAM_cm    : num  12 11 17 12 18 12 23 22 29 32 ...
##  $ SEEDS_DC    : num  26.7 26.7 26.7 26.7 26.7 ...
##  $ MEDIAN_INFL : int  5 0 5 0 5 5 18 18 18 18 ...
##  $ INFL_CLASS  : int  1 0 1 0 1 1 2 2 2 2 ...
##  $ MAX_INFL    : int  111 0 111 0 111 111 123 123 123 123 ...
##  $ OBS_INLF    : int  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEDS_YR_INF: num  NA NA NA NA NA NA NA NA NA NA ...
##  $ CAGED       : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ WATERED     : Factor w/ 2 levels &quot;N&quot;,&quot;Y&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ SEEDS       : num  71.8 0 71.8 0 71.8 ...</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(andre[, <span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">3</span>, <span class="dv">16</span>)])</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## &#39;data.frame&#39;:    1221 obs. of  4 variables:
##  $ PLANT_UNQ: Factor w/ 619 levels &quot;1_701&quot;,&quot;1_702&quot;,..: 462 464 473 477 482 487 474 479 483 463 ...
##  $ YEAR     : int  1994 1994 1994 1994 1994 1994 1994 1994 1994 1994 ...
##  $ CLASS    : Factor w/ 6 levels &quot;A1&quot;,&quot;A2&quot;,&quot;A3&quot;,..: 1 1 1 1 1 1 2 2 2 3 ...
##  $ SEEDS    : num  71.8 0 71.8 0 71.8 ...</code></pre>
<p>Go back to step 2.</p></p></div>
<ul class="tags">
  
    <li><strong>Tags: </strong></li>
    
    <li><a href="/tags.html#D-RUG-ref">D-RUG</a></li>
    
    <li><a href="/tags.html#R-ref">R</a></li>
    
    <li><a href="/tags.html#matrix-models-ref">matrix-models</a></li>
      
</ul>



  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'noamrossgh'; // required: replace example with your forum shortname
    var disqus_identifier = '/blog/2013/4/4/oleary-popbio-presentation.html';
    var disqus_url = 'http://www.noamross.net/blog/2013/4/4/oleary-popbio-presentation.html';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<div class="noprint"><hr />
<p> <strong>Previous Post</strong>: <em><a href="/blog/2013/2/20/model-selection-drug.html">Model Selection and Multi-Model Inference</a></em> </p>
<p> <strong>Next Post</strong>: <em><a href="/blog/2013/4/18/r-debug-tools.html">Debugging Tools in R with Michael Hannon</a></em> </p></div>



        </div>
    

      </div>
      
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="/assets/themes/noamblog/footnote-links.js"></script>
<script type="text/javascript">$('div.contenttext').footnoteLinks();</script>
</body>
</html>
