
<!DOCTYPE html> 
<!--
	Noam's theme, based on Readnik scriptogr.am theme
-->
<html lang="en">
<head>
  <title>Noam Ross | A Null Model for Age Effects in Disease with Multiple Infections</title>
  <meta name="description" content=" " />
  <meta name="author" content="Noam Ross">
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="ROBOTS" content="INDEX,FOLLOW">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta property="og:url" content="">
  <meta property="og:site_name" content="Noam Ross">
  <link rel="icon" type="image/x-icon" href="/assets/themes/noamblog/atom.ico">
  <link href="/assets/themes/noamblog/css/style.css" rel="stylesheet" type="text/css" media="all">
  <link href="http://feeds.feedburner.com/noamross" rel="alternate" type="application/rss+xml" title="Noam Ross" />
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30394461-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
 </script>
 <script type="text/javascript"> 
    function typeset() {
      MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
    function disqus_config() {
      this.callbacks.onNewComment = [typeset];
      this.callbacks.onInit = [typeset];
    }
  </script>
  <script src="http://cachedcommons.org/javascripts/text/prettify-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/text/showdown-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/jquery/jquery.disqus.js" type="text/javascript"></script>
  <script type="text/javascript" src="/assets/themes/noamblog/app.js"></script>  
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ "HTML-CSS": { availableFonts: ["TeX"], webfont: [null] }} ); </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ TeX: { extensions: ["autobold.js"] }} ); </script>
  <script type="text/javascript">var switchTo5x=true;</script>
  <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
  <script type="text/javascript">stLight.options({publisher: "4376beef-ffcc-441e-a877-904acf7f379b", theme:'8', onhover:false, doNotHash:true, doNotCopy:true, hashAddressBar:false}); </script>
  <script type="text/javascript">
      function chgifr(url, iframe)  {
          document.getElementById(iframe).src = url;
      }
  </script>
  <script type="text/javascript">
      function showhide(id) {
           var e = document.getElementById(id);
           if(e.style.display == 'block')
              e.style.display = 'none';
           else
              e.style.display = 'block';
        }
  </script>
</head>
<body>
<div class="wrapper">
  <div class="blog">
 
      <div id="menu" class="menu-top">
        <div class="blog-info">
          <h1><a href="/index.html">Noam Ross</a></h1>
          <div class="blog-description">
           <h2>Real-time research in ecology, economics, and sustainability</h2>
          </div>
         </div>
          <div class="pages">
            
            <!-- Lockerz Share BEGIN -->
            <a class="a2a_dd" href="http://www.addtoany.com/share_save" tile"Share this Page"><span class="shareicon"><span class="hide">Share</span></span></a>
            <script type="text/javascript">
            var a2a_config = a2a_config || {};
            a2a_config.onclick = 0;
            a2a_config.show_title = 1;
            a2a_config.color_main = "FFFFFF";
            a2a_config.color_border = "FFFFFF";
            a2a_config.color_link_text = "45462f";
            a2a_config.color_link_text_hover = "575757";
            a2a_config.prioritize = ["twitter", "facebook", "tumblr", "email", "delicious", "linkedin", "stumbleupon", "google_plus"];
            </script>
            <script type="text/javascript" src="http://static.addtoany.com/menu/page.js"></script>
            <!-- Lockerz Share END -->
            
            <a href="http://feeds.feedburner.com/noamross" title="Subscribe via Feedburner RSS"> <span class="rssicon"> <span class="hide">RSS</span></span></a>
            
             
             
            


  
    
  
    
    	
    	<a href="/about.html">About</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/connect.html">Connect</a>
    	
    
  
    
  
    
    	
    	<a href="/index.html">Blog</a>
    	
    
  
    
  
    
  
    
    	
    	<a href="/publications.html">Publications</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/tags.html">Topics</a>
    	
    
  
    
  



            
        </div>
      </div>

      <div class="container">

        <div class="content">
          
<div id="headblock">
<h1 id="page.title"><a href="/blog/2013/6/11/multi-infection-tests.html">A Null Model for Age Effects in Disease with Multiple Infections</a></h1>
<p>by <em>Noam Ross</em>, 11 June 2013</p>
<hr />
</div>
<div class="contenttext"><p><p><em>Here’s a little thought exercise I did that has caused me to go back and restart my Sudden Oak Death modeling in a new framework. Feedback welcome. I’m especially interested in relevant literature – I haven’t found many good examples of macroparasite/multiple infection models with age structure.</em></p>
<h2 id="introduction">Introduction</h2>
<p>Cobb et al. (2012) develop two models of forest stand demography in the face of Sudden Oak Death. The first, a statistical survival model, estimated the rates of infection and time-to-mortality as functions of density of infected trees and tree size. The second, an <span class="math">\(SI\)</span> model, projected stand composition over time using parameters from the first.</p>
<p>I’ve been realizing is that the observed data and the first model may not square with the second model. In an <span class="math">\(SI\)</span> model, all infected hosts are the same and, at least as implemented in this paper, infected trees have a constant rate of mortality. But if you look at the bottom-right portion of the figure below, you’ll see that the rate of mortality is strongly influenced by the number of infected hosts.</p>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/Cobb2012Fig2f.svg" alt="Parts of Figure 1 from Cobb et al. (2012)" /><p class="caption">Parts of Figure 1 from Cobb et al. (2012)</p>
</div>
<p><a href="https://sites.google.com/a/ucdavis.edu/richard-cobb/">Richard</a> and I discussed what might be driving this pattern, and think it might be due to the fact that trees can be infected mutiple times. <em>Phytophthora ramorum</em> doesn’t travel throughout a tree once infecting, but instead causes local lesions on leaves and local cankers on stems. A tree can accumulate more of these as more spores land on it. Thus, it may not be appropriate to represent infection as a binary state.</p>
<p>It’s also possible that multiple infection is driving another pattern. The upper-right panel above shows that there are strong size effects on mortality. It’s certainly possible that larger (or older) trees are more physiologically vulnerable to the disease. However, I think part of this may be due to the fact that larger trees have been around longer, and thus have had more time to acquire infections.</p>
<p>I’m exploring these hypotheses using a model adapted from Anderson and May (1978). This is a macroparasite model that explicitly considers the number of parasites in each host. My model takes its basic structure and applies it to two explicit size classes of organisms, in this case applied to trees:</p>
<p><span class="math">\[\begin{aligned}
  \frac{dJ}{dt}  &amp;= A f_A \left(1 - \frac{J+A}{K} \right) + J  \left(f_J \left(1 - \frac{J+A}{K} \right) - d_J - g\right) - \alpha P_J \\
  \frac{dA}{dt}  &amp;= J g - A d_A - \alpha P_A \\
  \frac{dP_J}{dt}  &amp;= \lambda  \frac{J}{K} (P_J + P_A)  - P_J \left(d_J + \mu + g + \alpha \left(1 + \frac{P_J}{J} \right) \right) \\
  \frac{dP_A}{dt}  &amp;= \lambda  \frac{A}{K} (P_J + P_A)  + P_J  g - P_A \left(d_A + \mu + \alpha \left(1 + \frac{P_A}{A}  \right) \right)
\end{aligned}\]</span></p>
<p>Here <span class="math">\(J\)</span> and <span class="math">\(A\)</span> are the population of juvenile and adult trees. There’s only two size classes for simplicity, though there’s no reason this can’t be extended to more. <span class="math">\(P_J\)</span> and <span class="math">\(P_A\)</span> are the total numbers of infections amongst those trees. Here’s a table of the parameters:</p>
<table>
<caption>Model parameter definitions</caption>
<thead>
<tr class="header">
<th align="center">Parameter</th>
<th align="center">Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math">\(f_J, f_J\)</span></td>
<td align="center">Fecundity of the size class</td>
</tr>
<tr class="even">
<td align="center"><span class="math">\(d_J, d_A\)</span></td>
<td align="center">Mortality rate of the size class</td>
</tr>
<tr class="odd">
<td align="center"><span class="math">\(g\)</span></td>
<td align="center">Rate at which juveniles become adults</td>
</tr>
<tr class="even">
<td align="center"><span class="math">\(\alpha\)</span></td>
<td align="center">Amount by which a single infection increases the mortality rate</td>
</tr>
<tr class="odd">
<td align="center"><span class="math">\(\mu\)</span></td>
<td align="center">Rate at which trees recover from infections (ignored here)</td>
</tr>
<tr class="even">
<td align="center"><span class="math">\(K\)</span></td>
<td align="center">Carrying capacity</td>
</tr>
<tr class="odd">
<td align="center"><span class="math">\(\lambda\)</span></td>
<td align="center">Rate at which new infections are created by a single infection.</td>
</tr>
</tbody>
</table>
<p>Some notes on the model: These equations assume that infections are completely randomly (Poisson) distributed amongst the hosts. This is unrealistic; due to spatial structure and other processes, the distribution is probably overdispersed. Secondly, unlike the Anderson and May (1978) model, there’s density dependence in recruitment of new juveniles – shading out of new recruits. Finally, transmission is density-dependent. I assume a spore’s chance of hitting a tree is proportional to the amount of space (carrying capacity) that the tree takes up.</p>
<h2 id="parameterizing-and-running-the-model">Parameterizing and Running the Model</h2>
<p>I define the equations and parameters in R:</p>
<pre class="sourceCode r"><code class="sourceCode r">
model &lt;-<span class="st"> </span>function(t, y, parms) {
  <span class="kw">list2env</span>(<span class="kw">as.list</span>(y), <span class="kw">environment</span>())
  <span class="kw">list2env</span>(<span class="kw">as.list</span>(parms), <span class="kw">environment</span>())
  dJ &lt;-<span class="st"> </span>A*f_a*(<span class="dv">1</span> -<span class="st"> </span>(J+A)/K) +<span class="st"> </span>J *<span class="st"> </span>(f_j*(<span class="dv">1</span> -<span class="st"> </span>(J+A)/K) -<span class="st"> </span>d_j -<span class="st"> </span>g) -<span class="st"> </span>alpha *<span class="st"> </span>PJ
  dA &lt;-<span class="st"> </span>J*g -<span class="st"> </span>(A *<span class="st"> </span>d_a) -<span class="st"> </span>alpha *<span class="st"> </span>PA
  dPJ &lt;-<span class="st"> </span>lambda *<span class="st"> </span>(PJ +<span class="st"> </span>PA) *<span class="st"> </span>J/K -<span class="st"> </span>PJ*(d_j +<span class="st"> </span>mu +<span class="st"> </span>g +<span class="st"> </span>alpha*(<span class="dv">1</span> +<span class="st"> </span>PJ/J))
  dPA &lt;-<span class="st"> </span>lambda *<span class="st"> </span>(PJ +<span class="st"> </span>PA) *<span class="st"> </span>A/K +<span class="st"> </span>PJ *<span class="st"> </span>g -<span class="st"> </span>PA*(d_a +<span class="st"> </span>mu +<span class="st"> </span>alpha*(<span class="dv">1</span> +<span class="st"> </span>PA/A))
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="kw">c</span>(<span class="dt">dJ=</span>dJ, <span class="dt">dA=</span>dA, <span class="dt">dPJ=</span>dPJ, <span class="dt">dPA=</span>dPA), 
              <span class="kw">c</span>(<span class="dt">dJ=</span>dJ, <span class="dt">dA=</span>dA, <span class="dt">dPJ=</span>dPJ, <span class="dt">dPA=</span>dPA)))
}

parms &lt;-<span class="st"> </span><span class="kw">c</span>( 
  <span class="dt">f_j=</span><span class="fl">0.01</span>,
  <span class="dt">f_a=</span><span class="fl">0.01</span>,
  <span class="dt">g=</span><span class="fl">0.1</span>,
  <span class="dt">d_j=</span><span class="fl">0.005</span>,
  <span class="dt">d_a=</span><span class="fl">0.005</span>,
  <span class="dt">alpha=</span><span class="fl">0.05</span>,
  <span class="dt">lambda=</span><span class="fl">0.3</span>,
  <span class="dt">K=</span><span class="dv">50</span>,
  <span class="dt">mu=</span><span class="fl">0.00</span>
  )</code></pre>
<p>Note from the parameters that here the juvenile and adult trees are exactly the same in their demographic variables, their contribution to density dependence and their response to disease. That is why I call this a “null model for age effects”; any differences between the behavior of the size classes will be due to structural effects of the model. Namely, that some trees carry disease as they move from juvenile to adult size class.</p>
<p>The parameters are selected to be somewhat realistic for tanoak and based on Cobb et al. (2012). Effectively, the juvenile class contains trees with &lt;1 cm diameter and adults are anything larger. The carrying capacity (<span class="math">\(K=50\)</span>) is about equal to the stand density of many in the plots the Cobb et al. (2012) data set.</p>
<p>I initiate the model with tree populations at their disease-free steady state, and with an average of 0.1 infection per tree. Note that the steady state has a high proportion of adults due to the parameterization. Since density dependence in the model only affects recruitment of new juveniles, their population is limited by the natural death rate of adults.</p>
<pre class="sourceCode r"><code class="sourceCode r">A_ss =<span class="st"> </span><span class="kw">with</span>(<span class="kw">as.list</span>(parms), K/(d_a/g +<span class="st"> </span><span class="dv">1</span>))
J_ss =<span class="st"> </span><span class="kw">with</span>(<span class="kw">as.list</span>(parms), K -<span class="st"> </span>A_ss)
init &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dt">J=</span>J_ss, <span class="dt">A=</span>A_ss, <span class="dt">PJ=</span><span class="fl">0.1</span>*J_ss, <span class="dt">PA=</span><span class="fl">0.1</span>*A_ss)</code></pre>
<p>Now I run the model and calculate some relevant values that I’ll explain when I plot them:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(deSolve)
<span class="kw">require</span>(reshape2)
out &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">lsoda</span>(<span class="dt">y=</span>init, <span class="dt">times=</span><span class="dv">1</span>:<span class="dv">100</span>, <span class="dt">func=</span>model, <span class="dt">parms=</span>parms))
df &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(out)
<span class="kw">names</span>(df)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Time&quot;</span>

df &lt;-<span class="st"> </span><span class="kw">within</span>(df, {
  <span class="kw">list2env</span>(<span class="kw">as.list</span>(parms), <span class="kw">environment</span>())
  pctJ &lt;-<span class="st"> </span>J/(J +<span class="st"> </span>A)
  pctA &lt;-<span class="st"> </span>A/(J +<span class="st"> </span>A)
  nJ &lt;-<span class="st"> </span>PJ /<span class="st"> </span>J
  nA &lt;-<span class="st"> </span>PA /<span class="st"> </span>A
  J.inf &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">exp</span>(-nJ)
  A.inf &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">exp</span>(-nA)
  Inf.dens &lt;-<span class="st"> </span>(J*J.inf +<span class="st"> </span>A*A.inf)
  J.mort &lt;-<span class="st"> </span>d_j +<span class="st"> </span>alpha *<span class="st"> </span>PJ /(J *<span class="st"> </span>J.inf)
  A.mort &lt;-<span class="st"> </span>d_a +<span class="st"> </span>alpha *<span class="st"> </span>PA /<span class="st"> </span>(A *<span class="st"> </span>A.inf)
  J.yrs &lt;-<span class="st"> </span><span class="dv">1</span>/J.mort
  A.yrs &lt;-<span class="st"> </span><span class="dv">1</span>/A.mort
  J.infrate &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">exp</span>(-lambda *<span class="st"> </span>(PJ +<span class="st"> </span>PA) *<span class="st"> </span>J *<span class="st"> </span><span class="kw">exp</span>(-PJ/J) /<span class="st"> </span>K)
  A.infrate &lt;-<span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">exp</span>(-lambda *<span class="st"> </span>(PJ +<span class="st"> </span>PA) *<span class="st"> </span>A *<span class="st"> </span><span class="kw">exp</span>(-PA/A) /<span class="st"> </span>K)
  J.infyrs &lt;-<span class="st"> </span><span class="dv">1</span>/J.infrate
  A.infyrs &lt;-<span class="st"> </span><span class="dv">1</span>/A.infrate
  <span class="kw">rm</span>(<span class="dt">list=</span><span class="kw">names</span>(parms))
})

df &lt;-<span class="st"> </span>df[,<span class="kw">sort</span>(<span class="kw">names</span>(df), <span class="dt">decreasing=</span><span class="ot">TRUE</span>)]

mdf &lt;-<span class="st"> </span><span class="kw">melt</span>(df, <span class="dt">id.vars=</span><span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Inf.dens&quot;</span>), <span class="dt">variable.name=</span><span class="st">&quot;Class&quot;</span>,
            <span class="dt">value.name=</span><span class="st">&quot;Population&quot;</span>)</code></pre>
<h2 id="results-and-discussion">Results and Discussion</h2>
<p>OK, so what does this look like? First, I plot the absolute and relative population sizes over time:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(ggplot2)
<span class="kw">require</span>(gridExtra)
JAlab &lt;-<span class="st"> </span><span class="kw">scale_color_discrete</span>(<span class="dt">labels=</span><span class="kw">c</span>(<span class="st">&quot;Small Trees&quot;</span>,<span class="st">&quot;Big Trees&quot;</span>))
p1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(mdf, Class %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J&quot;</span>, <span class="st">&quot;A&quot;</span>)), 
             <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>Population, <span class="dt">col=</span>Class)) +<span class="st"> </span>
<span class="st">      </span><span class="kw">geom_line</span>(<span class="dt">lwd=</span><span class="dv">1</span>) +<span class="st"> </span>theme_nr +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Population&quot;</span>) +<span class="st"> </span>JAlab
p2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(mdf, Class %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;pctJ&quot;</span>, <span class="st">&quot;pctA&quot;</span>)), 
             <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>Population, <span class="dt">col=</span>Class)) +<span class="st"> </span>
<span class="st">      </span><span class="kw">geom_line</span>(<span class="dt">lwd=</span><span class="dv">1</span>) +<span class="st"> </span>theme_nr +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Fraction of Population&quot;</span>) +<span class="st"> </span>JAlab
<span class="kw">grid.arrange</span>(p1, p2, <span class="dt">nrow=</span><span class="dv">2</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/multi-infection-tests-unnamed-chunk-4.png" />
</div>
<p>As in the <span class="math">\(SI\)</span> model, the population drops, but the relative proportion of juvenile trees goes up. This occurs even though the mortality effect of one infection is the same on both classes. However, this could also be due to the fact that with fewer trees, density dependence has less of an effect on recruitment. Let’s look at the prevalance of disease, overall and per-tree:</p>
<pre class="sourceCode r"><code class="sourceCode r">p3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(mdf, Class %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;PJ&quot;</span>, <span class="st">&quot;PA&quot;</span>)),
             <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>Population, <span class="dt">col=</span>Class)) +
<span class="st">      </span><span class="kw">geom_line</span>(<span class="dt">lwd=</span><span class="dv">1</span>) +<span class="st"> </span>theme_nr +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Number of Infections&quot;</span>) +<span class="st"> </span>JAlab
p4 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(mdf, Class %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;nJ&quot;</span>, <span class="st">&quot;nA&quot;</span>)),
             <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>Population, <span class="dt">col=</span>Class)) +
<span class="st">      </span><span class="kw">geom_line</span>(<span class="dt">lwd=</span><span class="dv">1</span>) +<span class="st"> </span>theme_nr +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Infections per Individual&quot;</span>) +<span class="st"> </span>JAlab
<span class="kw">grid.arrange</span>(p3, p4, <span class="dt">nrow=</span><span class="dv">2</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/multi-infection-tests-unnamed-chunk-5.png" />
</div>
<p>Infection is considerably greater in the adult trees than the juveniles over the course of the epidemic. Since, for the most part, observqtions of SOD don’t count the number of infections, it might be easier to look at this in terms of the number of trees infected. If we continue to assume a Poisson distribution of infections, we can calculate the fraction of infected trees as</p>
<p><span class="math">\[\frac{I}{N} = 1 - e^{-\frac{P_N}{N}}\]</span></p>
<p>with <span class="math">\(N\)</span> being a stand-in for <span class="math">\(J\)</span> or <span class="math">\(A\)</span>.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">subset</span>(mdf, Class %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J.inf&quot;</span>, <span class="st">&quot;A.inf&quot;</span>)), 
       <span class="kw">aes</span>(<span class="dt">x=</span>Time, <span class="dt">y=</span>Population, <span class="dt">col=</span>Class)) +<span class="st"> </span>
<span class="kw">geom_line</span>(<span class="dt">lwd=</span><span class="dv">1</span>) +<span class="st"> </span>theme_nr +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Fraction infected&quot;</span>) +<span class="st"> </span>JAlab</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/multi-infection-tests-unnamed-chunk-6.png" />
</div>
<p>Note that these curves are somewhat closer to each other. Without observing multiple infections per tree, we might think distributions of disease in each size class are more similar than they really are.</p>
<p>So how does mortality differ between the classes? I calculate the “observed” mortality rate as the total mortality rate of <em>only the diseased trees</em>. This is:</p>
<p><span class="math">\[d + \frac{\alpha P_N}{N (1 - \left( e^{- \frac{P_N}{N}}\right)}\]</span></p>
<p>The inverse of this value is “Years to infection”, which is the value shown in the right-hand panels of the figure from Cobb et al. (2012) above. Here I plot the “Years to mortality” that would be observed for trees in the model against the number of total infected trees in the population:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">subset</span>(mdf, Class %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J.yrs&quot;</span>, <span class="st">&quot;A.yrs&quot;</span>) ), 
       <span class="kw">aes</span>(<span class="dt">x=</span>Inf.dens, <span class="dt">y=</span>Population, <span class="dt">col=</span>Class)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">cex=</span><span class="dv">4</span>) +<span class="st"> </span>theme_nr +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Number of infected trees&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Years to death of infected individuals&quot;</span>) +<span class="st"> </span>JAlab</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/multi-infection-tests-unnamed-chunk-7.png" />
</div>
<p>This plot is not quite equivalent to the lower-right panel in the figure from Cobb et al. (2012), because that shows a snapshot in time of many sites, while this shows the path of one site through time. Nonetheless, it shows that years-to-death has a negative relationship with the number of infected trees in this model, albeit a relationship that is state-dependent. That I can recreate this effect with this model suggests the multiple infection may drive this pattern.</p>
<p>Note that the mortality rate of both juveniles and adults start out the same (Years to death <span class="math">\(\approx\)</span> 100), despite a higher adult population. I think ths means the difference of infection rates is not just due to a greater adult population, but due to the infections acquired by that class as more infected juveniles age into it.</p>
<p>The expression for the rate of infection of uninfected trees is:</p>
<p><span class="math">\[\underbrace{1 - e^{-\left(\lambda (P_J + P_A) \frac{\overbrace{Ne^{(-P_N/N)}}^{\text{previously uninfected trees}}}{K}\right)}}_{\text{fraction newly infected}}  \]</span></p>
<p>The inverse of this is “Years to Infection”, which I plot below against the number of infected trees.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="kw">subset</span>(mdf, Class %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;J.infyrs&quot;</span>, <span class="st">&quot;A.infyrs&quot;</span>) ), 
       <span class="kw">aes</span>(<span class="dt">x=</span>Inf.dens, <span class="dt">y=</span>Population, <span class="dt">col=</span>Class)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">cex=</span><span class="dv">4</span>) +<span class="st"> </span>theme_nr +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Number of infected trees&quot;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Years to infection of uninfected individuals&quot;</span>) +<span class="st"> </span>JAlab +<span class="st"> </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">200</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/multi-infection-tests-unnamed-chunk-8.png" />
</div>
<p>This is the rough equivalent to the bottom-left panel above from the Cobb et al. (2012). I’ve cut it off above 200 because years-to-infection quickly rise as the infection rate approaches zero. Neverthless, there’s a similar pattern to year-to-mortality, albeit shallower at the beginning and steeper at the end of the epidemic.</p>
<h2 id="next-steps">Next steps</h2>
<p>This looks like a good start. This model is generating patterns observed in data on Sudden Oak Death in the wild, some explained and some unexplained. Some next steps:</p>
<ul>
<li>Examine the effect and robustness to overdisperal, when infections are distributed as a negative binomial. <a href="http://clas-pages.uncc.edu/ross-meentemeyer/">Ross Meentemeyer</a> has data on the distribution of infections on Bay Laurel trees that may be useful in parameterizing this.</li>
<li>Build in the multi-species case where there are reservoir/spreader species (Bay Laurel) and inert competitors (Redwood).</li>
<li>Generalize to more size classes. Not strictly neccessary for prediction, but important for robustness.</li>
</ul>
<h2 id="references">References</h2>
<p>Anderson, R. M., and R. M. May. 1978. Regulation and stability of host-parasite population interactions: I. Regulatory processes. The Journal of Animal Ecology 47:219–247.</p>
<p>Cobb, R. C., J. A. N. Filipe, R. K. Meentemeyer, C. A. Gilligan, and D. M. Rizzo. 2012. Ecosystem transformation by emerging infectious disease: loss of large tanoak from California forests. Journal of Ecology 100:712–722.</p></p></div>
<ul class="tags">
  
    <li><strong>Tags: </strong></li>
    
    <li><a href="/tags.html#R-ref">R</a></li>
    
    <li><a href="/tags.html#SOD-ref">SOD</a></li>
      
</ul>



  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'noamrossgh'; // required: replace example with your forum shortname
    var disqus_identifier = '/blog/2013/6/11/multi-infection-tests.html';
    var disqus_url = 'http://www.noamross.net/blog/2013/6/11/multi-infection-tests.html';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<div class="noprint"><hr />
<p> <strong>Previous Post</strong>: <em><a href="/blog/2013/5/30/new-paper-post.html">Early Warning Signals: the Charted and Uncharted Territories</a></em> </p>
<p> <strong>Next Post</strong>: <em><a href="/blog/2013/6/12/multi-infection-overdispersed.html">The null model for age effects with overdispersed infection</a></em> </p></div>



        </div>
    

      </div>
      
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="/assets/themes/noamblog/footnote-links.js"></script>
<script type="text/javascript">$('div.contenttext').footnoteLinks();</script>
</body>
</html>
