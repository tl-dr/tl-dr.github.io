
<!DOCTYPE html> 
<!--
	Noam's theme, based on Readnik scriptogr.am theme
-->
<html lang="en">
<head>
  <title>Noam Ross | Lauren Yamane on Matrix Population Models in R</title>
  <meta name="description" content=" " />
  <meta name="author" content="Noam Ross">
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="ROBOTS" content="INDEX,FOLLOW">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta property="og:url" content="">
  <meta property="og:site_name" content="Noam Ross">
  <link rel="icon" type="image/x-icon" href="/assets/themes/noamblog/atom.ico">
  <link href="/assets/themes/noamblog/css/style.css" rel="stylesheet" type="text/css" media="all">
  <link href="http://feeds.feedburner.com/noamross" rel="alternate" type="application/rss+xml" title="Noam Ross" />
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30394461-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
 </script>
 <script type="text/javascript"> 
    function typeset() {
      MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
    function disqus_config() {
      this.callbacks.onNewComment = [typeset];
      this.callbacks.onInit = [typeset];
    }
  </script>
  <script src="http://cachedcommons.org/javascripts/text/prettify-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/text/showdown-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/jquery/jquery.disqus.js" type="text/javascript"></script>
  <script type="text/javascript" src="/assets/themes/noamblog/app.js"></script>  
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ "HTML-CSS": { availableFonts: ["TeX"], webfont: [null] }} ); </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ TeX: { extensions: ["autobold.js"] }} ); </script>
  <script type="text/javascript">var switchTo5x=true;</script>
  <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
  <script type="text/javascript">stLight.options({publisher: "4376beef-ffcc-441e-a877-904acf7f379b", theme:'8', onhover:false, doNotHash:true, doNotCopy:true, hashAddressBar:false}); </script>
  <script type="text/javascript">
      function chgifr(url, iframe)  {
          document.getElementById(iframe).src = url;
      }
  </script>
  <script type="text/javascript">
      function showhide(id) {
           var e = document.getElementById(id);
           if(e.style.display == 'block')
              e.style.display = 'none';
           else
              e.style.display = 'block';
        }
  </script>
</head>
<body>
<div class="wrapper">
  <div class="blog">
 
      <div id="menu" class="menu-top">
        <div class="blog-info">
          <h1><a href="/index.html">Noam Ross</a></h1>
          <div class="blog-description">
           <h2>Real-time research in ecology, economics, and sustainability</h2>
          </div>
         </div>
          <div class="pages">
            
            <!-- Lockerz Share BEGIN -->
            <a class="a2a_dd" href="http://www.addtoany.com/share_save" tile"Share this Page"><span class="shareicon"><span class="hide">Share</span></span></a>
            <script type="text/javascript">
            var a2a_config = a2a_config || {};
            a2a_config.onclick = 0;
            a2a_config.show_title = 1;
            a2a_config.color_main = "FFFFFF";
            a2a_config.color_border = "FFFFFF";
            a2a_config.color_link_text = "45462f";
            a2a_config.color_link_text_hover = "575757";
            a2a_config.prioritize = ["twitter", "facebook", "tumblr", "email", "delicious", "linkedin", "stumbleupon", "google_plus"];
            </script>
            <script type="text/javascript" src="http://static.addtoany.com/menu/page.js"></script>
            <!-- Lockerz Share END -->
            
            <a href="http://feeds.feedburner.com/noamross" title="Subscribe via Feedburner RSS"> <span class="rssicon"> <span class="hide">RSS</span></span></a>
            
             
             
            


  
    
  
    
    	
    	<a href="/about.html">About</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/connect.html">Connect</a>
    	
    
  
    
  
    
    	
    	<a href="/index.html">Blog</a>
    	
    
  
    
  
    
  
    
    	
    	<a href="/publications.html">Publications</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/tags.html">Topics</a>
    	
    
  
    
  



            
        </div>
      </div>

      <div class="container">

        <div class="content">
          
<div id="headblock">
<h1 id="page.title"><a href="/blog/2012/11/30/lauren-yamane-on-matrix-population-models.html">Lauren Yamane on Matrix Population Models in R</a></h1>
<p>by <em>Noam Ross</em>, 30 November 2012</p>
<hr />
</div>
<div class="contenttext"><p><p>Last week in <a href="http://www.noamross.net/davis-r-users-group.html">Davis R Usersâ€™ Group</a>, Lauren Yamane showed us how she created and analyzed a stochastic age-structured population in R. Her examples are below. Her original scripts can be found as <code>*.Rmd</code> files <a href="https://gist.github.com/4197507">here</a></p>
<p>A note to UC Davis students: This topic and others will be covered by Marissa Baskett and Sebastian Schreiber in their course this winter, <em>Computational methods in population biology</em> (ECL298)</p>
<hr />
<h2 id="a-discrete-time-age-structured-model-of-a-salmon-population-semelparous-that-can-live-to-age-5-with-fishing-and-environmental-stochasticity">A discrete time, age-structured model of a salmon population (semelparous) that can live to age 5, with fishing and environmental stochasticity</h2>
<p>Parameter values</p>
<pre class="sourceCode r"><code class="sourceCode r">a =<span class="st"> </span><span class="dv">60</span>  <span class="co">#alpha for Beverton-Holt stock-recruitment curve</span>
b =<span class="st"> </span><span class="fl">0.00017</span>  <span class="co">#beta for Beverton-Holt</span>
tf =<span class="st"> </span><span class="dv">2000</span>  <span class="co">#number of time steps</span>
N0 =<span class="st"> </span><span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)  <span class="co">#initial population vector for 5 age classes</span>
s =<span class="st"> </span><span class="fl">0.28</span>  <span class="co">#survival rate with fishing</span>
e =<span class="st"> </span><span class="fl">0.1056</span>  <span class="co">#fraction of age 3 fish that spawn early (age 4 is mean spawner age)</span>
l =<span class="st"> </span><span class="fl">0.1056</span>  <span class="co">#fraction of age 4 fish that spawn late as age 5 fish</span>
sx =<span class="st"> </span><span class="kw">c</span>(s, s, (s *<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>e)), (s *<span class="st"> </span>(l)))  <span class="co">#survival vector for all ages with fishing, spawners die after spawning</span>
t &lt;-<span class="st"> </span><span class="dv">1</span>  <span class="co">#start off at time=1</span></code></pre>
<p>Make a function for the age-structured matrix</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Make a function for the age-structured matrix with fishing</span>
AgeStructMatrix_F =<span class="st"> </span>function(sx, a, b, tf, N0) {
    sig_r =<span class="st"> </span><span class="fl">0.3</span>
    ncls =<span class="st"> </span><span class="kw">length</span>(N0)  <span class="co">#Number of age classes</span>
    Nt_F =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, tf, ncls)  <span class="co">#Initialize output matrix with time steps as rows, age classes as columns</span>
    Nt_F[<span class="dv">1</span>, ] =<span class="st"> </span>N0  <span class="co">#put initial values into first row of output matrix</span>
    for (t in <span class="dv">1</span>:(tf -<span class="st"> </span><span class="dv">1</span>)) {
        <span class="co">#for time step t in 1:1999</span>
        Pt =<span class="st"> </span>(e *<span class="st"> </span>Nt_F[t, <span class="dv">3</span>]) +<span class="st"> </span>((<span class="dv">1</span> -<span class="st"> </span>l) *<span class="st"> </span>Nt_F[t, <span class="dv">4</span>]) +<span class="st"> </span>Nt_F[t, <span class="dv">5</span>]  <span class="co">#number of spawners</span>
        Nt_F[t +<span class="st"> </span><span class="dv">1</span>, <span class="dv">1</span>] =<span class="st"> </span>((a *<span class="st"> </span>Pt)/(<span class="dv">1</span> +<span class="st"> </span>(b *<span class="st"> </span>Pt))) *<span class="st"> </span>(<span class="kw">exp</span>(sig_r *<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, <span class="dt">mean =</span> <span class="dv">0</span>, 
            <span class="dt">sd =</span> <span class="dv">1</span>)))  <span class="co">#number of recruits with environmental stochasticity</span>
        Nt_F[t +<span class="st"> </span><span class="dv">1</span>, <span class="dv">2</span>:ncls] =<span class="st"> </span>sx *<span class="st"> </span>Nt_F[t, <span class="dv">1</span>:(ncls -<span class="st"> </span><span class="dv">1</span>)]  <span class="co">#number of age classes 2-5</span>
    }
    <span class="kw">return</span>(Nt_F)
}</code></pre>
<p>Run model by calling function</p>
<pre class="sourceCode r"><code class="sourceCode r">Nt_F =<span class="st"> </span><span class="kw">AgeStructMatrix_F</span>(sx, a, b, tf, N0)</code></pre>
<p>Plot of time series with all 5 age classes</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">matplot</span>(<span class="dv">1</span>:tf, Nt_F, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Population size&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Age-structured model with fishing&quot;</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/ageclassplot.png" />
</div>
<p>Export text file for plot with age classes</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(Nt_F) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Recruits&quot;</span>, <span class="st">&quot;Age2&quot;</span>, <span class="st">&quot;Age3&quot;</span>, <span class="st">&quot;Age4&quot;</span>, <span class="st">&quot;Age5&quot;</span>)  <span class="co">#Rename columns</span>
<span class="kw">write.table</span>(Nt_F, <span class="st">&quot;~/Desktop/Nt_F.txt&quot;</span>, <span class="dt">col.names =</span> <span class="ot">TRUE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, 
    <span class="dt">quote =</span> <span class="ot">FALSE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)  <span class="co">#comma separated</span></code></pre>
<p>Or plot of time series for total population</p>
<pre class="sourceCode r"><code class="sourceCode r">Nt_F_totals =<span class="st"> </span><span class="kw">rowSums</span>(Nt_F)
<span class="kw">plot</span>(<span class="kw">c</span>(<span class="dv">1</span>:tf), Nt_F_totals, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Time&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Population size&quot;</span>, 
    <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/totalpopplot.png" />
</div>
<p>Export text file for plot with total population</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">write.table</span>(Nt_F_totals, <span class="st">&quot;~/Desktop/Nt_F_totals.txt&quot;</span>, <span class="dt">col.names =</span> <span class="ot">FALSE</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>, 
    <span class="dt">quote =</span> <span class="ot">FALSE</span>, <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>)</code></pre>
<h2 id="stability-analysis-of-deterministic-population-model">Stability analysis of deterministic population model</h2>
<p>This assumes that the partial differential equations that make up the Jacobian matrix have been determined analytically. Below are the parameters that were associated with my age-structured salmon model with fishing. I can compare the stability of the population with fishing to that with no fishing</p>
<pre class="sourceCode r"><code class="sourceCode r">e &lt;-<span class="st"> </span><span class="fl">0.1056</span>
l &lt;-<span class="st"> </span><span class="fl">0.1056</span>
s &lt;-<span class="st"> </span><span class="fl">0.28</span>  <span class="co">#survival with fishing</span>
s_noF &lt;-<span class="st"> </span><span class="fl">0.85</span>  <span class="co">#survival with no fishing</span>
c &lt;-<span class="st"> </span><span class="dv">1</span>/((e *<span class="st"> </span>(s^<span class="dv">2</span>) +<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>e) *<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>l) *<span class="st"> </span>(s^<span class="dv">3</span>) +<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>e) *<span class="st"> </span>l *<span class="st"> </span>(s^<span class="dv">4</span>)))
c_noF &lt;-<span class="st"> </span><span class="dv">1</span>/((e *<span class="st"> </span>(s_noF^<span class="dv">2</span>) +<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>e) *<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>l) *<span class="st"> </span>(s_noF^<span class="dv">3</span>) +<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>e) *<span class="st"> </span>l *<span class="st"> </span>(s_noF^<span class="dv">4</span>)))
alpha &lt;-<span class="st"> </span><span class="dv">60</span>
beta &lt;-<span class="st"> </span><span class="fl">0.00017</span></code></pre>
<p>Fishing Jacobian</p>
<pre class="sourceCode r"><code class="sourceCode r">one_F &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, ((alpha *<span class="st"> </span>e)/(<span class="dv">1</span> +<span class="st"> </span>(<span class="dv">1</span>/(<span class="dv">2</span> *<span class="st"> </span>c)) *<span class="st"> </span>(-c +<span class="st"> </span>alpha +<span class="st"> </span><span class="kw">sqrt</span>((c -<span class="st"> </span>alpha)^<span class="dv">2</span>)))^<span class="dv">2</span>), 
    ((alpha *<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>l))/(<span class="dv">1</span> +<span class="st"> </span>(<span class="dv">1</span>/(<span class="dv">2</span> *<span class="st"> </span>c)) *<span class="st"> </span>(-c +<span class="st"> </span>alpha +<span class="st"> </span><span class="kw">sqrt</span>((c -<span class="st"> </span>alpha)^<span class="dv">2</span>)))^<span class="dv">2</span>), 
    (alpha/(<span class="dv">1</span> +<span class="st"> </span>(<span class="dv">1</span>/(<span class="dv">2</span> *<span class="st"> </span>c)) *<span class="st"> </span>(-c +<span class="st"> </span>alpha +<span class="st"> </span><span class="kw">sqrt</span>((c -<span class="st"> </span>alpha)^<span class="dv">2</span>)))^<span class="dv">2</span>))
two_F &lt;-<span class="st"> </span><span class="kw">c</span>(s, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)
three_F &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, s, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)
four_F &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, ((<span class="dv">1</span> -<span class="st"> </span>e) *<span class="st"> </span>s), <span class="dv">0</span>, <span class="dv">0</span>)
five_F &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, (l *<span class="st"> </span>s), <span class="dv">0</span>)
jacobian_F &lt;-<span class="st"> </span><span class="kw">rbind</span>(one_F, two_F, three_F, four_F, five_F)
jacobian_F</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#         [,1] [,2]   [,3]     [,4]  [,5]</span>
<span class="co"># one_F   0.00 0.00 2.5214 21.35558 23.88</span>
<span class="co"># two_F   0.28 0.00 0.0000  0.00000  0.00</span>
<span class="co"># three_F 0.00 0.28 0.0000  0.00000  0.00</span>
<span class="co"># four_F  0.00 0.00 0.2504  0.00000  0.00</span>
<span class="co"># five_F  0.00 0.00 0.0000  0.02957  0.00</span></code></pre>
<p>Fishing Eigenvalues</p>
<pre class="sourceCode r"><code class="sourceCode r">ev_F &lt;-<span class="st"> </span><span class="kw">eigen</span>(jacobian_F)
ev1_F =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_F$values[<span class="dv">1</span>]), <span class="kw">Im</span>(ev_F$values[<span class="dv">1</span>]))
ev2_F =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_F$values[<span class="dv">2</span>]), <span class="kw">Im</span>(ev_F$values[<span class="dv">2</span>]))
ev3_F =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_F$values[<span class="dv">3</span>]), <span class="kw">Im</span>(ev_F$values[<span class="dv">3</span>]))
ev4_F =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_F$values[<span class="dv">4</span>]), <span class="kw">Im</span>(ev_F$values[<span class="dv">4</span>]))
ev5_F =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_F$values[<span class="dv">5</span>]), <span class="kw">Im</span>(ev_F$values[<span class="dv">5</span>]))</code></pre>
<p>No Fishing Jacobian</p>
<pre class="sourceCode r"><code class="sourceCode r">one_noF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, ((alpha *<span class="st"> </span>e)/(<span class="dv">1</span> +<span class="st"> </span>(<span class="dv">1</span>/(<span class="dv">2</span> *<span class="st"> </span>c_noF)) *<span class="st"> </span>(-c_noF +<span class="st"> </span>alpha +<span class="st"> </span><span class="kw">sqrt</span>((c_noF -<span class="st"> </span>
<span class="st">    </span>alpha)^<span class="dv">2</span>)))^<span class="dv">2</span>), ((alpha *<span class="st"> </span>(<span class="dv">1</span> -<span class="st"> </span>l))/(<span class="dv">1</span> +<span class="st"> </span>(<span class="dv">1</span>/(<span class="dv">2</span> *<span class="st"> </span>c_noF)) *<span class="st"> </span>(-c_noF +<span class="st"> </span>alpha +<span class="st"> </span>
<span class="st">    </span><span class="kw">sqrt</span>((c_noF -<span class="st"> </span>alpha)^<span class="dv">2</span>)))^<span class="dv">2</span>), (alpha/(<span class="dv">1</span> +<span class="st"> </span>(<span class="dv">1</span>/(<span class="dv">2</span> *<span class="st"> </span>c_noF)) *<span class="st"> </span>(-c_noF +<span class="st"> </span>alpha +<span class="st"> </span>
<span class="st">    </span><span class="kw">sqrt</span>((c_noF -<span class="st"> </span>alpha)^<span class="dv">2</span>)))^<span class="dv">2</span>))
two_noF &lt;-<span class="st"> </span><span class="kw">c</span>(s_noF, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)
three_noF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, s_noF, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>)
four_noF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, ((<span class="dv">1</span> -<span class="st"> </span>e) *<span class="st"> </span>s_noF), <span class="dv">0</span>, <span class="dv">0</span>)
five_noF &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, (l *<span class="st"> </span>s_noF), <span class="dv">0</span>)
jacobian_noF &lt;-<span class="st"> </span><span class="kw">rbind</span>(one_noF, two_noF, three_noF, four_noF, five_noF)
jacobian_noF</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="co">#           [,1] [,2]     [,3]    [,4]   [,5]</span>
<span class="co"># one_noF   0.00 0.00 0.004625 0.03917 0.0438</span>
<span class="co"># two_noF   0.85 0.00 0.000000 0.00000 0.0000</span>
<span class="co"># three_noF 0.00 0.85 0.000000 0.00000 0.0000</span>
<span class="co"># four_noF  0.00 0.00 0.760240 0.00000 0.0000</span>
<span class="co"># five_noF  0.00 0.00 0.000000 0.08976 0.0000</span></code></pre>
<p>No Fishing Eigenvalues</p>
<pre class="sourceCode r"><code class="sourceCode r">ev_noF &lt;-<span class="st"> </span><span class="kw">eigen</span>(jacobian_noF)
ev1_noF =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_noF$values[<span class="dv">1</span>]), <span class="kw">Im</span>(ev_noF$values[<span class="dv">1</span>]))
ev2_noF =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_noF$values[<span class="dv">2</span>]), <span class="kw">Im</span>(ev_noF$values[<span class="dv">2</span>]))
ev3_noF =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_noF$values[<span class="dv">3</span>]), <span class="kw">Im</span>(ev_noF$values[<span class="dv">3</span>]))
ev4_noF =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_noF$values[<span class="dv">4</span>]), <span class="kw">Im</span>(ev_noF$values[<span class="dv">4</span>]))
ev5_noF =<span class="st"> </span><span class="kw">c</span>(<span class="kw">Re</span>(ev_noF$values[<span class="dv">5</span>]), <span class="kw">Im</span>(ev_noF$values[<span class="dv">5</span>]))

<span class="co"># Setup for plot, just remember to expand the plot interface first</span>
<span class="kw">library</span>(plotrix)  <span class="co">#load plotrix</span></code></pre>
<p>Plot the eigenvalues with legend to compare stability of both deterministic models</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>), <span class="dv">2</span>, <span class="dv">3</span>, <span class="dt">byrow =</span> <span class="ot">TRUE</span>))  <span class="co">#Layout with 2 rows, 3 columns,</span>
<span class="co"># the matrix tells you the number of the figure in each location. Since</span>
<span class="co"># the layout is byrow, it fills the first row first and then the 2nd row</span>
<span class="co"># no fishing plot</span>
<span class="kw">plot</span>(ev1_noF[<span class="dv">1</span>], ev1_noF[<span class="dv">2</span>], <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">pch =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">xlab =</span> <span class="st">&quot;Real&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Imaginary&quot;</span>, 
    <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="fl">1.25</span>, <span class="fl">1.25</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="fl">1.25</span>, <span class="fl">1.25</span>))
<span class="kw">title</span>(<span class="st">&quot;No fishing&quot;</span>, <span class="dt">adj =</span> <span class="dv">0</span>)  <span class="co">#plot dominant eigenvalue, with x-coordinate as real part and y-coordinate as imaginary part</span>
<span class="kw">draw.circle</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">radius =</span> <span class="dv">1</span>, <span class="dt">border =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)  <span class="co">#draw unit circle</span>
<span class="kw">points</span>(ev2_noF[<span class="dv">1</span>], ev2_noF[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">2</span>)  <span class="co">#2nd eigenvalue</span>
<span class="kw">points</span>(ev3_noF[<span class="dv">1</span>], ev3_noF[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="dv">2</span>)  <span class="co">#3rd eigenvalue</span>
<span class="kw">points</span>(ev4_noF[<span class="dv">1</span>], ev4_noF[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">6</span>, <span class="dt">cex =</span> <span class="dv">2</span>)  <span class="co">#4th eigenvalue</span>
<span class="kw">points</span>(ev5_noF[<span class="dv">1</span>], ev5_noF[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">5</span>, <span class="dt">cex =</span> <span class="dv">2</span>)  <span class="co">#5th eigenvalue</span>
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="ot">NULL</span>, <span class="dt">b =</span> <span class="ot">NULL</span>, <span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="ot">NULL</span>, <span class="dt">b =</span> <span class="ot">NULL</span>, <span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)

<span class="co"># fishing plot</span>
<span class="kw">plot</span>(ev1_F[<span class="dv">1</span>], ev1_F[<span class="dv">2</span>], <span class="dt">type =</span> <span class="st">&quot;p&quot;</span>, <span class="dt">pch =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="dv">2</span>, <span class="dt">xlab =</span> <span class="st">&quot;Real&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Imaginary&quot;</span>, 
    <span class="dt">xlim =</span> <span class="kw">c</span>(-<span class="fl">1.25</span>, <span class="fl">1.25</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(-<span class="fl">1.25</span>, <span class="fl">1.25</span>))
<span class="kw">title</span>(<span class="st">&quot;Fishing&quot;</span>, <span class="dt">adj =</span> <span class="dv">0</span>)
<span class="kw">draw.circle</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dt">radius =</span> <span class="dv">1</span>, <span class="dt">border =</span> <span class="st">&quot;black&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">lwd =</span> <span class="dv">1</span>)
<span class="kw">points</span>(ev2_F[<span class="dv">1</span>], ev2_F[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="dv">2</span>)
<span class="kw">points</span>(ev3_F[<span class="dv">1</span>], ev3_F[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="dv">2</span>)
<span class="kw">points</span>(ev4_F[<span class="dv">1</span>], ev4_F[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">6</span>, <span class="dt">cex =</span> <span class="dv">2</span>)
<span class="kw">points</span>(ev5_F[<span class="dv">1</span>], ev5_F[<span class="dv">2</span>], <span class="dt">pch =</span> <span class="dv">5</span>, <span class="dt">cex =</span> <span class="dv">2</span>)
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="ot">NULL</span>, <span class="dt">b =</span> <span class="ot">NULL</span>, <span class="dt">h =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)
<span class="kw">abline</span>(<span class="dt">a =</span> <span class="ot">NULL</span>, <span class="dt">b =</span> <span class="ot">NULL</span>, <span class="dt">v =</span> <span class="dv">0</span>, <span class="dt">lty =</span> <span class="dv">3</span>)

<span class="co"># Legend</span>
<span class="kw">plot</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">frame.plot =</span> <span class="ot">TRUE</span>)
<span class="kw">title</span>(<span class="st">&quot;Legend&quot;</span>, <span class="dt">adj =</span> <span class="dv">0</span>)
<span class="kw">text</span>(<span class="fl">6.5</span>, <span class="fl">9.5</span>, <span class="kw">expression</span>(lambda[<span class="dv">1</span>]), <span class="dt">cex =</span> <span class="fl">1.2</span>)
<span class="kw">text</span>(<span class="fl">6.5</span>, <span class="fl">7.5</span>, <span class="kw">expression</span>(lambda[<span class="dv">2</span>]), <span class="dt">cex =</span> <span class="fl">1.2</span>)
<span class="kw">text</span>(<span class="fl">6.5</span>, <span class="fl">5.5</span>, <span class="kw">expression</span>(lambda[<span class="dv">3</span>]), <span class="dt">cex =</span> <span class="fl">1.2</span>)
<span class="kw">text</span>(<span class="fl">6.5</span>, <span class="fl">3.5</span>, <span class="kw">expression</span>(lambda[<span class="dv">4</span>]), <span class="dt">cex =</span> <span class="fl">1.2</span>)
<span class="kw">text</span>(<span class="fl">6.5</span>, <span class="fl">1.5</span>, <span class="kw">expression</span>(lambda[<span class="dv">5</span>]), <span class="dt">cex =</span> <span class="fl">1.2</span>)
<span class="kw">points</span>(<span class="fl">4.5</span>, <span class="fl">9.5</span>, <span class="dt">pch =</span> <span class="dv">0</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)
<span class="kw">points</span>(<span class="fl">4.5</span>, <span class="fl">7.5</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)
<span class="kw">points</span>(<span class="fl">4.5</span>, <span class="fl">5.5</span>, <span class="dt">pch =</span> <span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)
<span class="kw">points</span>(<span class="fl">4.5</span>, <span class="fl">3.5</span>, <span class="dt">pch =</span> <span class="dv">6</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)
<span class="kw">points</span>(<span class="fl">4.5</span>, <span class="fl">1.5</span>, <span class="dt">pch =</span> <span class="dv">5</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/ploteigenvalues.png" />
</div></p></div>
<ul class="tags">
  
    <li><strong>Tags: </strong></li>
    
    <li><a href="/tags.html#R-ref">R</a></li>
    
    <li><a href="/tags.html#DRUG-ref">DRUG</a></li>
    
    <li><a href="/tags.html#population-dynamics-ref">population-dynamics</a></li>
    
    <li><a href="/tags.html#matrix-models-ref">matrix-models</a></li>
      
</ul>



  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'noamrossgh'; // required: replace example with your forum shortname
    var disqus_identifier = '/blog/2012/11/30/lauren-yamane-on-matrix-population-models.html';
    var disqus_url = 'http://www.noamross.net/blog/2012/11/30/lauren-yamane-on-matrix-population-models.html';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<div class="noprint"><hr />
<p> <strong>Previous Post</strong>: <em><a href="/blog/2012/11/28/lab-meeting-presentation-outline.html">A multi-species, age-structured model for forest disease</a></em> </p>
<p> <strong>Next Post</strong>: <em><a href="/blog/2012/12/17/quals-reading-list.html">Qualifying Exam Reading List</a></em> </p></div>



        </div>
    

      </div>
      
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="/assets/themes/noamblog/footnote-links.js"></script>
<script type="text/javascript">$('div.contenttext').footnoteLinks();</script>
</body>
</html>
