
<!DOCTYPE html> 
<!--
	Noam's theme, based on Readnik scriptogr.am theme
-->
<html lang="en">
<head>
  <title>Noam Ross | Simulating Sudden Oak Death Dynamics</title>
  <meta name="description" content=" " />
  <meta name="author" content="Noam Ross">
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="ROBOTS" content="INDEX,FOLLOW">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta property="og:url" content="">
  <meta property="og:site_name" content="Noam Ross">
  <link rel="icon" type="image/x-icon" href="/assets/themes/noamblog/atom.ico">
  <link href="/assets/themes/noamblog/css/style.css" rel="stylesheet" type="text/css" media="all">
  <link href="http://feeds.feedburner.com/noamross" rel="alternate" type="application/rss+xml" title="Noam Ross" />
  <script type="text/javascript">

    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-30394461-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
 </script>
 <script type="text/javascript"> 
    function typeset() {
      MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
    function disqus_config() {
      this.callbacks.onNewComment = [typeset];
      this.callbacks.onInit = [typeset];
    }
  </script>
  <script src="http://cachedcommons.org/javascripts/text/prettify-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/text/showdown-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/jquery/jquery.disqus.js" type="text/javascript"></script>
  <script type="text/javascript" src="/assets/themes/noamblog/app.js"></script>  
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ "HTML-CSS": { availableFonts: ["TeX"], webfont: [null] }} ); </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ TeX: { extensions: ["autobold.js"] }} ); </script>
  <script type="text/javascript">var switchTo5x=true;</script>
  <script type="text/javascript" src="http://w.sharethis.com/button/buttons.js"></script>
  <script type="text/javascript">stLight.options({publisher: "4376beef-ffcc-441e-a877-904acf7f379b", theme:'8', onhover:false, doNotHash:true, doNotCopy:true, hashAddressBar:false}); </script>
  <script type="text/javascript">
      function chgifr(url, iframe)  {
          document.getElementById(iframe).src = url;
      }
  </script>
  <script type="text/javascript">
      function showhide(id) {
           var e = document.getElementById(id);
           if(e.style.display == 'block')
              e.style.display = 'none';
           else
              e.style.display = 'block';
        }
  </script>
</head>
<body>
<div class="wrapper">
  <div class="blog">
 
      <div id="menu" class="menu-top">
        <div class="blog-info">
          <h1><a href="/index.html">Noam Ross</a></h1>
          <div class="blog-description">
           <h2>Real-time research in ecology, economics, and sustainability</h2>
          </div>
         </div>
          <div class="pages">
            
            <!-- Lockerz Share BEGIN -->
            <a class="a2a_dd" href="http://www.addtoany.com/share_save" tile"Share this Page"><span class="shareicon"><span class="hide">Share</span></span></a>
            <script type="text/javascript">
            var a2a_config = a2a_config || {};
            a2a_config.onclick = 0;
            a2a_config.show_title = 1;
            a2a_config.color_main = "FFFFFF";
            a2a_config.color_border = "FFFFFF";
            a2a_config.color_link_text = "45462f";
            a2a_config.color_link_text_hover = "575757";
            a2a_config.prioritize = ["twitter", "facebook", "tumblr", "email", "delicious", "linkedin", "stumbleupon", "google_plus"];
            </script>
            <script type="text/javascript" src="http://static.addtoany.com/menu/page.js"></script>
            <!-- Lockerz Share END -->
            
            <a href="http://feeds.feedburner.com/noamross" title="Subscribe via Feedburner RSS"> <span class="rssicon"> <span class="hide">RSS</span></span></a>
            
             
             
            


  
    
  
    
    	
    	<a href="/about.html">About</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/connect.html">Connect</a>
    	
    
  
    
  
    
    	
    	<a href="/index.html">Blog</a>
    	
    
  
    
  
    
  
    
    	
    	<a href="/publications.html">Publications</a>
    	
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
    	
    	<a href="/tags.html">Topics</a>
    	
    
  
    
  



            
        </div>
      </div>

      <div class="container">

        <div class="content">
          
<div id="headblock">
<h1 id="page.title"><a href="/blog/2012/11/16/sod-dynamics-1.html">Simulating Sudden Oak Death Dynamics</a></h1>
<p>by <em>Noam Ross</em>, 16 November 2012</p>
<hr />
</div>
<div class="contenttext"><p><p>I am working on a project with the <a href="http://ucanr.edu/sites/rizzolab/">Rizzo Lab</a> examining the dynamics of Sudden Oak Death (SOD). I really have to write more about this, but today I’m just going to post the results of an initial exercise.</p>
<p>Here I attempt to replicate model results from Cobb et al. (2012). The model in that paper simulates the spread of disease and resulting tree mortality and stand dynamics in a mixed system of tanoak, bay laurel, and redwood. In this system, only tanoak and bay laurel carry the disease, and it mostly only kills tanoak, but all three species compete for space in the forest. More detail on the model found in the paper and the paper’s supplement.</p>
<p>I’m developing this model as an R package -<code>&quot;SODDr&quot;</code> (Sudden Oak Death Dynamics in R), to replicate this work, you can install it from github. Note that this is a very rough package and is changing.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(devtools) <span class="co"># devtools enables intsallation from alternate code locations</span>
<span class="kw">install_github</span>(<span class="st">&quot;SODDr&quot;</span>,<span class="st">&quot;noamross&quot;</span>)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(SODDr)</code></pre>
<p>My model modifies the original in a few ways. First, it’s designed to be much more flexible, and make it easy to modify the number of species, size classes, and and disease parameters. Secondly, it is in a discrete- rather than continuous-time framework. This will make it easier to include stochasticity down the road, and ultimately fit it to actual data.</p>
<h2 id="setup">Setup</h2>
<p>First, I load a CSV file of parameters</p>
<pre class="sourceCode r"><code class="sourceCode r">treeparms.df &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="kw">system.file</span>(<span class="st">&quot;paper_tree_parms_eq.csv&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;SODDr&quot;</span>), 
    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>)
<span class="kw">print</span>(treeparms.df)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##   species ageclass S.mortality I.mortality S.recruit I.recruit
## 1       1        1      0.0061       0.019        NA        NA
## 2       1        2      0.0031       0.022     0.007     0.007
## 3       1        3      0.0011       0.035     0.020     0.020
## 4       1        4      0.0320       0.140     0.073     0.073
## 5       2        1      0.0200       0.020        NA        NA
## 6       3        1      0.0050       0.020        NA        NA
##   S.transition I.transition S.resprout I.resprout recover space
## 1      0.05212      0.05212          0        0.5    0.01    NA
## 2      0.01848      0.01848          0        0.5    0.01    NA
## 3      0.01473      0.01473          0        0.5    0.01    NA
## 4      0.00000      0.00000          0        0.5    0.01    NA
## 5      0.00000      0.00000          0        0.0    0.10     1
## 6      0.00000      0.00000          0        0.0    0.10     1
##            kernel.fn kernel.par1 kernel.par2  S.init I.init waifw1 waifw2
## 1 adjacent.dispersal         0.5       0.125 0.03860      0   0.33   0.33
## 2 adjacent.dispersal         0.5       0.125 0.09785      0   0.32   0.32
## 3 adjacent.dispersal         0.5       0.125 0.11379      0   0.30   0.30
## 4 adjacent.dispersal         0.5       0.125 0.04827      0   0.24   0.24
## 5 adjacent.dispersal         0.5       0.125 0.11550      0   0.30   0.30
## 6 adjacent.dispersal         0.5       0.125 0.32550      0   0.00   0.00
##   waifw3 waifw4 waifw5 waifw6
## 1   0.33   0.33   1.46      0
## 2   0.32   0.32   1.46      0
## 3   0.30   0.30   1.46      0
## 4   0.24   0.24   1.46      0
## 5   0.30   0.30   1.33      0
## 6   0.00   0.00   0.00      0</code></pre>
<p>This data set includes all of the model parameters as defined by Cobb et al. (2012). For each species and age class, there are parameters for mortality, recruitment, transition between classes, the probability of resprouting, and recovering from disease. There are also parameters the the relative amount of space occupied by trees of each species/class.</p>
<p>For each species/class, the table includes a kernel function to describe dispersal of disease spores from diseased trees, and parameters for that function. The last set of columns represent the “&quot;Who Acquires Infection From Whom” (WAIFW) matrix (Anderson and May 1985), which describes the vulnerability of each class to spores originating from others.</p>
<p>Note that several values, such as the space occupied by different tanoak size classes, and recruitment rates, are missing. This is because, per the original paper, I calculate these so as to parameterize the model for steady-state conditions in the absence of disease. Here I do that, using Equation 8 in the papers’ supplement:</p>
<pre class="sourceCode r"><code class="sourceCode r">treeparms.df &lt;-<span class="st"> </span><span class="kw">within</span>(treeparms.df, {
    <span class="co"># Calculate the relative space requirements of tanoak size classes based</span>
    <span class="co"># on initial conditions</span>
    space[<span class="dv">1</span>:<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="fl">0.25</span> *<span class="st"> </span>(<span class="kw">sum</span>(S.init[<span class="dv">1</span>:<span class="dv">4</span>])/S.init[<span class="dv">1</span>:<span class="dv">4</span>])
    
    <span class="co"># Set recruitment rates to steady-state levels.  For Redwood and Bay, this</span>
    <span class="co"># is simply the mortality rate divided by the density-dependence</span>
    <span class="co"># coefficient at simulation start.  For tanoak, which has multiple size</span>
    <span class="co"># classes, it&#39;s a but more involved</span>
    
    S.recruit[<span class="dv">5</span>] &lt;-<span class="st"> </span>S.mortality[<span class="dv">5</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    I.recruit[<span class="dv">5</span>] &lt;-<span class="st"> </span>I.mortality[<span class="dv">5</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    S.recruit[<span class="dv">6</span>] &lt;-<span class="st"> </span>S.mortality[<span class="dv">6</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    I.recruit[<span class="dv">6</span>] &lt;-<span class="st"> </span>I.mortality[<span class="dv">6</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    
    A2 &lt;-<span class="st"> </span>S.transition[<span class="dv">1</span>]/(S.transition[<span class="dv">2</span>] +<span class="st"> </span>S.mortality[<span class="dv">2</span>])
    A3 &lt;-<span class="st"> </span>(S.transition[<span class="dv">2</span>]/(S.transition[<span class="dv">3</span>] +<span class="st"> </span>S.mortality[<span class="dv">3</span>])) *<span class="st"> </span>A2
    A4 &lt;-<span class="st"> </span>(S.transition[<span class="dv">3</span>]/S.mortality[<span class="dv">4</span>]) *<span class="st"> </span>A3
    S.recruit[<span class="dv">1</span>] &lt;-<span class="st"> </span>(S.transition[<span class="dv">1</span>] +<span class="st"> </span>S.mortality[<span class="dv">1</span>])/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space)) -<span class="st"> </span>
<span class="st">        </span>(S.recruit[<span class="dv">2</span>] *<span class="st"> </span>A2 +<span class="st"> </span>S.recruit[<span class="dv">3</span>] *<span class="st"> </span>A3 +<span class="st"> </span>S.recruit[<span class="dv">4</span>] *<span class="st"> </span>A4)
    
    
    I.recruit[<span class="dv">1</span>] &lt;-<span class="st"> </span>S.recruit[<span class="dv">1</span>]
    A2 &lt;-<span class="st"> </span><span class="ot">NULL</span>
    A3 &lt;-<span class="st"> </span><span class="ot">NULL</span>
    A4 &lt;-<span class="st"> </span><span class="ot">NULL</span>
})</code></pre>
<p>The original model allows only dispersal between adjacent cells, so the parameters table calls the dispersal kernel <code>adjacent.dispersal</code>, and gives two parameters. This function outputs the first parameter when within the cell, the second for dispersal to adjacent cells, and zero for other cells:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(adjacent.dispersal)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## function (distance, local, adjacent) 
## {
##     ifelse(distance &lt; 0.5, local, ifelse(distance &lt; 1.5, adjacent, 
##         0))
## }
## &lt;environment: namespace:SODDr&gt;</code></pre>
<p>Next I set up the locations in the model. These must be in the form of a matrix with the first column being site numbers, and the second being <code>x</code> and <code>y</code> coordinates. <code>MakeLattice</code> is a convenience function that creates a regularly spaced grid:</p>
<pre class="sourceCode r"><code class="sourceCode r">locations &lt;-<span class="st"> </span><span class="kw">MakeLattice</span>(<span class="dt">nx =</span> <span class="dv">20</span>, <span class="dt">ny =</span> <span class="dv">20</span>, <span class="dt">dist =</span> <span class="dv">1</span>)
<span class="kw">head</span>(locations)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">##      location x y
## [1,]        1 0 0
## [2,]        2 0 1
## [3,]        3 0 2
## [4,]        4 0 3
## [5,]        5 0 4
## [6,]        6 0 5</code></pre>
<p>Next, I create a matrix of initial population values, which should be sized by number of locations by number of species/size classes <em>times 2</em>. They should be in order of the classes as they appear in the data table, but alternating <span class="math">\(S,I,S,I,\dots\)</span>. In this case, initial populations are uniform across the landscape and equal to the <code>init</code> values from the parameters table.</p>
<pre class="sourceCode r"><code class="sourceCode r">initial.vec =<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">rbind</span>(treeparms.df$S.init, treeparms.df$I.init))
init &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> initial.vec, <span class="dt">nrow =</span> <span class="kw">nrow</span>(locations), <span class="dt">ncol =</span> <span class="dv">2</span> *<span class="st"> </span><span class="kw">nrow</span>(treeparms.df), 
    <span class="dt">byrow =</span> <span class="ot">TRUE</span>)</code></pre>
<p>Finally, we set the time steps for the model</p>
<pre class="sourceCode r"><code class="sourceCode r">time.steps &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">100</span></code></pre>
<h2 id="do-it">Do it!</h2>
<p>Running <code>SODModel</code> runs the model and generates a dataframe of population by time, species, size class, and disease status</p>
<pre class="sourceCode r"><code class="sourceCode r">pop.df &lt;-<span class="st"> </span><span class="kw">SODModel</span>(treeparms.df, locations, time.steps, init)
<span class="kw">str</span>(pop.df)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## &#39;data.frame&#39;:    480000 obs. of  6 variables:
##  $ Time      : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Location  : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ Species   : Factor w/ 3 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;: 1 1 1 1 1 1 1 1 2 2 ...
##  $ AgeClass  : Factor w/ 4 levels &quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;: 1 1 2 2 3 3 4 4 1 1 ...
##  $ Disease   : Factor w/ 2 levels &quot;S&quot;,&quot;I&quot;: 1 2 1 2 1 2 1 2 1 2 ...
##  $ Population: num  0.0386 0 0.0978 0 0.1138 ...</code></pre>
<h2 id="results">Results</h2>
<p>Here are the results, broken up by species and age class:</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(plyr)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## Attaching package: &#39;plyr&#39;

## The following object(s) are masked from &#39;package:twitteR&#39;:
## 
## id</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">pop.df.totals &lt;-<span class="st"> </span><span class="kw">ddply</span>(pop.df, <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;AgeClass&quot;</span>), 
    summarise, <span class="dt">TotPop =</span> <span class="kw">mean</span>(Population))
dynamic.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(pop.df.totals, <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> TotPop, <span class="dt">fill =</span> Disease, 
    <span class="dt">color =</span> AgeClass)) +<span class="st"> </span><span class="kw">geom_area</span>(<span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.6</span>) +<span class="st"> </span><span class="kw">facet_grid</span>(~Species)
dynamic.plot</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/tanoakdyn1/initrun.png" alt="Population dynamics broken up by species (left to right, Tanoak, Bay, Redwood), and Size Class" /><p class="caption">Population dynamics broken up by species (left to right, Tanoak, Bay, Redwood), and Size Class</p>
</div>
<p>The plot shows that this isn’t quite steady-state, I suspect because of some rounding errors in copying parameters from the paper.</p>
<p>We can make a plot in the style of Cobb et al. (2012), showing only the populations of small and large tanoaks as a proportion of the total population:</p>
<pre class="sourceCode r"><code class="sourceCode r">paper.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(<span class="kw">transform</span>(pop.df.totals, <span class="dt">Size =</span> <span class="kw">ifelse</span>(AgeClass ==<span class="st"> &quot;1&quot;</span> |<span class="st"> </span>AgeClass ==<span class="st"> </span>
<span class="st">    &quot;2&quot;</span>, <span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Large&quot;</span>)), <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Size&quot;</span>), summarise, <span class="dt">SizePop =</span> <span class="kw">sum</span>(TotPop))
paper.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(paper.df, <span class="st">&quot;Time&quot;</span>, transform, <span class="dt">Pct =</span> SizePop/<span class="kw">sum</span>(SizePop))
paper.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(paper.df, Species ==<span class="st"> </span><span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Pct, 
    <span class="dt">lty =</span> Size)) +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">lwd =</span> <span class="dv">1</span>) +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), 
    <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="dv">5</span>)) +<span class="st"> </span><span class="kw">theme_bw</span>() +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())
paper.plot</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/tanoakdyn1/papeplot.png" alt="Tanoak as a fraction of total population over time, no disease" /><p class="caption">Tanoak as a fraction of total population over time, no disease</p>
</div>
<p>Now, let’s change the initial conditions to include disease and see what happens. I change the populations of tanoak and bay in one pixel to infectious instead of susceptible and run the model:</p>
<pre class="sourceCode r"><code class="sourceCode r">init[<span class="dv">190</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>init[<span class="dv">190</span>, <span class="dv">1</span>]
init[<span class="dv">190</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
init[<span class="dv">190</span>, <span class="dv">10</span>] &lt;-<span class="st"> </span>init[<span class="dv">190</span>, <span class="dv">9</span>]
init[<span class="dv">190</span>, <span class="dv">9</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
pop2.df &lt;-<span class="st"> </span><span class="kw">SODModel</span>(treeparms.df, locations, time.steps, init)
pop2.df.totals &lt;-<span class="st"> </span><span class="kw">ddply</span>(pop2.df, <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;AgeClass&quot;</span>), 
    summarise, <span class="dt">TotPop =</span> <span class="kw">mean</span>(Population))
paper2.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(<span class="kw">transform</span>(pop2.df.totals, <span class="dt">Size =</span> <span class="kw">ifelse</span>(AgeClass ==<span class="st"> &quot;1&quot;</span> |<span class="st"> </span>
<span class="st">    </span>AgeClass ==<span class="st"> &quot;2&quot;</span>, <span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Large&quot;</span>)), <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Size&quot;</span>), summarise, 
    <span class="dt">SizePop =</span> <span class="kw">sum</span>(TotPop))
paper2.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(paper2.df, <span class="st">&quot;Time&quot;</span>, transform, <span class="dt">Pct =</span> SizePop/<span class="kw">sum</span>(SizePop))
paper2.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(paper2.df, Species ==<span class="st"> </span><span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Pct, 
    <span class="dt">lty =</span> Size)) +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">lwd =</span> <span class="dv">1</span>) +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), 
    <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="dv">5</span>)) +<span class="st"> </span><span class="kw">theme_bw</span>() +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())
paper2.plot</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/tanoakdyn1/disease1.png" alt="Tanoak as a fraction of total population, using baseline initial conditions and introducing disease" /><p class="caption">Tanoak as a fraction of total population, using baseline initial conditions and introducing disease</p>
</div>
<p>Qualitatively, this looks a lot like the original result:</p>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/cobb20124a.png" alt="Figure 4a from Cobb et al. (2012)" /><p class="caption">Figure 4a from Cobb et al. (2012)</p>
</div>
<p>The main difference is the overall rate of change, which is expected because I haven’t corrected any parameters for the change from continuous to discrete time.</p>
<p>Now I simulate a scenario with mostly tanoak, some redwood, and no bay laurel, with disease, using the parameters previously calulated for the steady state without disease:</p>
<pre class="sourceCode r"><code class="sourceCode r">treeparms.df$S.init &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.7</span> *<span class="st"> </span>treeparms.df$S.init[<span class="dv">1</span>:<span class="dv">4</span>]/<span class="kw">sum</span>(treeparms.df$S.init[<span class="dv">1</span>:<span class="dv">4</span>]), 
    <span class="dv">0</span>, <span class="fl">0.19</span>)

initial.vec =<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">rbind</span>(treeparms.df$S.init, treeparms.df$I.init))
init &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> initial.vec, <span class="dt">nrow =</span> <span class="kw">nrow</span>(locations), <span class="dt">ncol =</span> <span class="dv">2</span> *<span class="st"> </span><span class="kw">nrow</span>(treeparms.df), 
    <span class="dt">byrow =</span> <span class="ot">TRUE</span>)

init[<span class="dv">190</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>init[<span class="dv">190</span>, <span class="dv">1</span>]
init[<span class="dv">190</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
init[<span class="dv">190</span>, <span class="dv">10</span>] &lt;-<span class="st"> </span>init[<span class="dv">190</span>, <span class="dv">9</span>]
init[<span class="dv">190</span>, <span class="dv">9</span>] &lt;-<span class="st"> </span><span class="dv">0</span>

treeparms.df &lt;-<span class="st"> </span><span class="kw">within</span>(treeparms.df, {
    <span class="co"># Calculate the relative space requirements of tanoak size classes based</span>
    <span class="co"># on initial conditions</span>
    space[<span class="dv">1</span>:<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="fl">0.25</span> *<span class="st"> </span>(<span class="kw">sum</span>(S.init[<span class="dv">1</span>:<span class="dv">4</span>])/S.init[<span class="dv">1</span>:<span class="dv">4</span>])
    
    <span class="co"># Set recruitment rates to steady-state levels.  For Redwood and Bay, this</span>
    <span class="co"># is simply the mortality rate divided by the density-dependence</span>
    <span class="co"># coefficient at simulation start.  For tanoak, which has multiple size</span>
    <span class="co"># classes, it&#39;s a but more involved</span>
    
    S.recruit[<span class="dv">5</span>] &lt;-<span class="st"> </span>S.mortality[<span class="dv">5</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    I.recruit[<span class="dv">5</span>] &lt;-<span class="st"> </span>I.mortality[<span class="dv">5</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    S.recruit[<span class="dv">6</span>] &lt;-<span class="st"> </span>S.mortality[<span class="dv">6</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    I.recruit[<span class="dv">6</span>] &lt;-<span class="st"> </span>I.mortality[<span class="dv">6</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    
    A2 &lt;-<span class="st"> </span>S.transition[<span class="dv">1</span>]/(S.transition[<span class="dv">2</span>] +<span class="st"> </span>S.mortality[<span class="dv">2</span>])
    A3 &lt;-<span class="st"> </span>(S.transition[<span class="dv">2</span>]/(S.transition[<span class="dv">3</span>] +<span class="st"> </span>S.mortality[<span class="dv">3</span>])) *<span class="st"> </span>A2
    A4 &lt;-<span class="st"> </span>(S.transition[<span class="dv">3</span>]/S.mortality[<span class="dv">4</span>]) *<span class="st"> </span>A3
    S.recruit[<span class="dv">1</span>] &lt;-<span class="st"> </span>(S.transition[<span class="dv">1</span>] +<span class="st"> </span>S.mortality[<span class="dv">1</span>])/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space)) -<span class="st"> </span>
<span class="st">        </span>(S.recruit[<span class="dv">2</span>] *<span class="st"> </span>A2 +<span class="st"> </span>S.recruit[<span class="dv">3</span>] *<span class="st"> </span>A3 +<span class="st"> </span>S.recruit[<span class="dv">4</span>] *<span class="st"> </span>A4)
    
    
    I.recruit[<span class="dv">1</span>] &lt;-<span class="st"> </span>S.recruit[<span class="dv">1</span>]
    A2 &lt;-<span class="st"> </span><span class="ot">NULL</span>
    A3 &lt;-<span class="st"> </span><span class="ot">NULL</span>
    A4 &lt;-<span class="st"> </span><span class="ot">NULL</span>
})

pop3.df &lt;-<span class="st"> </span><span class="kw">SODModel</span>(treeparms.df, locations, time.steps, init)
pop3.df.totals &lt;-<span class="st"> </span><span class="kw">ddply</span>(pop3.df, <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;AgeClass&quot;</span>), 
    summarise, <span class="dt">TotPop =</span> <span class="kw">mean</span>(Population))
paper3.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(<span class="kw">transform</span>(pop3.df.totals, <span class="dt">Size =</span> <span class="kw">ifelse</span>(AgeClass ==<span class="st"> &quot;1&quot;</span> |<span class="st"> </span>
<span class="st">    </span>AgeClass ==<span class="st"> &quot;2&quot;</span>, <span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Large&quot;</span>)), <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Size&quot;</span>), summarise, 
    <span class="dt">SizePop =</span> <span class="kw">sum</span>(TotPop))
paper3.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(paper3.df, <span class="st">&quot;Time&quot;</span>, transform, <span class="dt">Pct =</span> SizePop/<span class="kw">sum</span>(SizePop))
paper3.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(paper3.df, Species ==<span class="st"> </span><span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Pct, 
    <span class="dt">lty =</span> Size)) +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">lwd =</span> <span class="dv">1</span>) +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), 
    <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="dv">5</span>)) +<span class="st"> </span><span class="kw">theme_bw</span>() +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())
paper3.plot</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## Warning: Removed 5 rows containing missing values (geom_path).</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/tanoakdyn1/disease2.png" alt="Tanoak dynamics under the Mostly Tanoak scenario" /><p class="caption">Tanoak dynamics under the “Mostly Tanoak” scenario</p>
</div>
<p>Again, qualitatively similar to the original results:</p>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/cobb2012fig4b.png" alt="Fig 4b from Cobb et al. (2012)" /><p class="caption">Fig 4b from Cobb et al. (2012)</p>
</div>
<p>Finally, I simulate the “Mostly Redwood” scenario:</p>
<pre class="sourceCode r"><code class="sourceCode r">treeparms.df$S.init &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.08</span> *<span class="st"> </span>treeparms.df$S.init[<span class="dv">1</span>:<span class="dv">4</span>]/<span class="kw">sum</span>(treeparms.df$S.init[<span class="dv">1</span>:<span class="dv">4</span>]), 
    <span class="dv">0</span>, <span class="fl">0.69</span>)

initial.vec =<span class="st"> </span><span class="kw">as.vector</span>(<span class="kw">rbind</span>(treeparms.df$S.init, treeparms.df$I.init))
init &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dt">data =</span> initial.vec, <span class="dt">nrow =</span> <span class="kw">nrow</span>(locations), <span class="dt">ncol =</span> <span class="dv">2</span> *<span class="st"> </span><span class="kw">nrow</span>(treeparms.df), 
    <span class="dt">byrow =</span> <span class="ot">TRUE</span>)

init[<span class="dv">190</span>, <span class="dv">2</span>] &lt;-<span class="st"> </span>init[<span class="dv">190</span>, <span class="dv">1</span>]
init[<span class="dv">190</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">0</span>
init[<span class="dv">190</span>, <span class="dv">10</span>] &lt;-<span class="st"> </span>init[<span class="dv">190</span>, <span class="dv">9</span>]
init[<span class="dv">190</span>, <span class="dv">9</span>] &lt;-<span class="st"> </span><span class="dv">0</span>

treeparms.df &lt;-<span class="st"> </span><span class="kw">within</span>(treeparms.df, {
    <span class="co"># Calculate the relative space requirements of tanoak size classes based</span>
    <span class="co"># on initial conditions</span>
    space[<span class="dv">1</span>:<span class="dv">4</span>] &lt;-<span class="st"> </span><span class="fl">0.25</span> *<span class="st"> </span>(<span class="kw">sum</span>(S.init[<span class="dv">1</span>:<span class="dv">4</span>])/S.init[<span class="dv">1</span>:<span class="dv">4</span>])
    
    <span class="co"># Set recruitment rates to steady-state levels.  For Redwood and Bay, this</span>
    <span class="co"># is simply the mortality rate divided by the density-dependence</span>
    <span class="co"># coefficient at simulation start.  For tanoak, which has multiple size</span>
    <span class="co"># classes, it&#39;s a but more involved</span>
    
    S.recruit[<span class="dv">5</span>] &lt;-<span class="st"> </span>S.mortality[<span class="dv">5</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    I.recruit[<span class="dv">5</span>] &lt;-<span class="st"> </span>I.mortality[<span class="dv">5</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    S.recruit[<span class="dv">6</span>] &lt;-<span class="st"> </span>S.mortality[<span class="dv">6</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    I.recruit[<span class="dv">6</span>] &lt;-<span class="st"> </span>I.mortality[<span class="dv">6</span>]/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space))
    
    A2 &lt;-<span class="st"> </span>S.transition[<span class="dv">1</span>]/(S.transition[<span class="dv">2</span>] +<span class="st"> </span>S.mortality[<span class="dv">2</span>])
    A3 &lt;-<span class="st"> </span>(S.transition[<span class="dv">2</span>]/(S.transition[<span class="dv">3</span>] +<span class="st"> </span>S.mortality[<span class="dv">3</span>])) *<span class="st"> </span>A2
    A4 &lt;-<span class="st"> </span>(S.transition[<span class="dv">3</span>]/S.mortality[<span class="dv">4</span>]) *<span class="st"> </span>A3
    S.recruit[<span class="dv">1</span>] &lt;-<span class="st"> </span>(S.transition[<span class="dv">1</span>] +<span class="st"> </span>S.mortality[<span class="dv">1</span>])/(<span class="dv">1</span> -<span class="st"> </span><span class="kw">sum</span>(S.init *<span class="st"> </span>space)) -<span class="st"> </span>
<span class="st">        </span>(S.recruit[<span class="dv">2</span>] *<span class="st"> </span>A2 +<span class="st"> </span>S.recruit[<span class="dv">3</span>] *<span class="st"> </span>A3 +<span class="st"> </span>S.recruit[<span class="dv">4</span>] *<span class="st"> </span>A4)
    
    
    I.recruit[<span class="dv">1</span>] &lt;-<span class="st"> </span>S.recruit[<span class="dv">1</span>]
    A2 &lt;-<span class="st"> </span><span class="ot">NULL</span>
    A3 &lt;-<span class="st"> </span><span class="ot">NULL</span>
    A4 &lt;-<span class="st"> </span><span class="ot">NULL</span>
})

pop4.df &lt;-<span class="st"> </span><span class="kw">SODModel</span>(treeparms.df, locations, time.steps, init)
pop4.df.totals &lt;-<span class="st"> </span><span class="kw">ddply</span>(pop4.df, <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Disease&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;AgeClass&quot;</span>), 
    summarise, <span class="dt">TotPop =</span> <span class="kw">mean</span>(Population))
paper4.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(<span class="kw">transform</span>(pop4.df.totals, <span class="dt">Size =</span> <span class="kw">ifelse</span>(AgeClass ==<span class="st"> &quot;1&quot;</span> |<span class="st"> </span>
<span class="st">    </span>AgeClass ==<span class="st"> &quot;2&quot;</span>, <span class="st">&quot;Small&quot;</span>, <span class="st">&quot;Large&quot;</span>)), <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Species&quot;</span>, <span class="st">&quot;Size&quot;</span>), summarise, 
    <span class="dt">SizePop =</span> <span class="kw">sum</span>(TotPop))
paper4.df &lt;-<span class="st"> </span><span class="kw">ddply</span>(paper4.df, <span class="st">&quot;Time&quot;</span>, transform, <span class="dt">Pct =</span> SizePop/<span class="kw">sum</span>(SizePop))
paper4.plot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="kw">subset</span>(paper4.df, Species ==<span class="st"> </span><span class="dv">1</span>), <span class="kw">aes</span>(<span class="dt">x =</span> Time, <span class="dt">y =</span> Pct, 
    <span class="dt">lty =</span> Size)) +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">lwd =</span> <span class="dv">1</span>) +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.6</span>), 
    <span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_x_continuous</span>(<span class="dt">expand =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) +<span class="st"> </span><span class="kw">scale_linetype_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="dv">1</span>, 
    <span class="dv">5</span>)) +<span class="st"> </span><span class="kw">theme_bw</span>() +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.grid.major =</span> <span class="kw">element_blank</span>(), <span class="dt">panel.grid.minor =</span> <span class="kw">element_blank</span>())
paper4.plot</code></pre>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/tanoakdyn1/disease3.png" alt="Tanoak dynamics under the mostly redwood scenario" /><p class="caption">Tanoak dynamics under the “mostly redwood” scenario</p>
</div>
<p>Success! Same results as the original:</p>
<div class="figure">
<img src="http://dl.dropbox.com/u/3356641/blogstuff/cobb2012fig4c.png" alt="Figure 4c from Cobb et al. (2012)" /><p class="caption">Figure 4c from Cobb et al. (2012)</p>
</div>
<p>Now, for fun, let’s make an animation of how the disease progresses through the stand. I will use the “Mostly Tanoak” scenario&quot;, and plot the adult population as intensity, and the fraction of trees diseased as hue.</p>
<pre class="sourceCode r"><code class="sourceCode r">tanspc &lt;-<span class="st"> </span><span class="kw">subset</span>(pop3.df, Species ==<span class="st"> </span><span class="dv">1</span>)
tanspc$Species &lt;-<span class="st"> </span><span class="ot">NULL</span>
tanspc &lt;-<span class="st"> </span><span class="kw">ddply</span>(tanspc, <span class="kw">c</span>(<span class="st">&quot;Time&quot;</span>, <span class="st">&quot;Location&quot;</span>), function(x) {
    <span class="kw">data.frame</span>(<span class="dt">TotTan =</span> <span class="kw">sum</span>(x$Population[<span class="kw">which</span>(x$AgeClass ==<span class="st"> &quot;3&quot;</span> |<span class="st"> </span>x$AgeClass ==<span class="st"> </span>
<span class="st">        &quot;4&quot;</span>)]), <span class="dt">FracDisease =</span> <span class="kw">sum</span>(x$Population[<span class="kw">which</span>(x$Disease ==<span class="st"> &quot;I&quot;</span> &amp;<span class="st"> </span>(x$AgeClass ==<span class="st"> </span>
<span class="st">        &quot;3&quot;</span> |<span class="st"> </span>x$AgeClass ==<span class="st"> &quot;4&quot;</span>))])/<span class="kw">sum</span>(x$Population[<span class="kw">which</span>(x$AgeClass ==<span class="st"> &quot;3&quot;</span> |<span class="st"> </span>
<span class="st">        </span>x$AgeClass ==<span class="st"> &quot;4&quot;</span>)]))
})
tanspc &lt;-<span class="st"> </span><span class="kw">merge</span>(tanspc, <span class="kw">as.data.frame</span>(locations), <span class="dt">by.x =</span> <span class="st">&quot;Location&quot;</span>, <span class="dt">by.y =</span> <span class="st">&quot;location&quot;</span>)
dis.limits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(tanspc$FracDisease), <span class="kw">max</span>(tanspc$FracDisease))
pop.limits &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">min</span>(tanspc$TotTan), <span class="kw">max</span>(tanspc$TotTan))
<span class="kw">require</span>(animation)</code></pre>
<pre class="sourceCode r"><code class="sourceCode r">## Loading required package: animation</code></pre>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ani.options</span>(<span class="dt">nmax =</span> <span class="dv">50</span>, <span class="dt">loop =</span> <span class="ot">TRUE</span>, <span class="dt">interval =</span> <span class="fl">0.2</span>)
for (time in time.steps) {
    <span class="kw">print</span>(<span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="kw">subset</span>(tanspc, Time ==<span class="st"> </span>time), <span class="kw">aes</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">fill =</span> FracDisease, 
        <span class="dt">alpha =</span> TotTan)) +<span class="st"> </span><span class="kw">geom_tile</span>() +<span class="st"> </span><span class="kw">scale_alpha</span>(<span class="dt">name =</span> <span class="st">&quot;TanoakPopulation&quot;</span>, 
        <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">0.4</span>, <span class="fl">0.1</span>)) +<span class="st"> </span><span class="kw">scale_fill_continuous</span>(<span class="dt">name =</span> <span class="st">&quot;Fraction Diseased&quot;</span>, 
        <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.25</span>), <span class="dt">low =</span> <span class="st">&quot;#408000&quot;</span>, <span class="dt">high =</span> <span class="st">&quot;#FF8000&quot;</span>) +<span class="st"> </span>
<span class="st">        </span><span class="kw">theme</span>(<span class="dt">rect =</span> <span class="kw">element_blank</span>(), <span class="dt">line =</span> <span class="kw">element_blank</span>()))
}</code></pre>
<video   controls="controls" loop="loop">
<source src="http://dl.dropbox.com/u/3356641/blogstuff/tanoakdyn1/tanoak-anim.mp4" type="video/mp4" />video of chunk tanoak-anim
</video>

<h2 id="references">References</h2>
<p>Anderson, R. M., and R. M. May. 1985. Age-related changes in the rate of disease transmission: implications for the design of vaccination programmes. J. Hyg. Camb.</p>
<p>Cobb, R. C., J. a. N. Filipe, R. K. Meentemeyer, C. a Gilligan, and D. M. Rizzo. 2012. Ecosystem transformation by emerging infectious disease: loss of large tanoak from California forests. Journal of Ecology.</p></p></div>
<ul class="tags">
  
    <li><strong>Tags: </strong></li>
    
    <li><a href="/tags.html#SOD-ref">SOD</a></li>
    
    <li><a href="/tags.html#R-ref">R</a></li>
      
</ul>



  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'noamrossgh'; // required: replace example with your forum shortname
    var disqus_identifier = '/blog/2012/11/16/sod-dynamics-1.html';
    var disqus_url = 'http://www.noamross.net/blog/2012/11/16/sod-dynamics-1.html';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<div class="noprint"><hr />
<p> <strong>Previous Post</strong>: <em><a href="/blog/2012/11/15/lecture---jordi-bascompte.html">Jordi Bascompte on Mutualistic Networks</a></em> </p>
<p> <strong>Next Post</strong>: <em><a href="/blog/2012/11/19/editing-csv-files-in-r.html">A quick function for editing CSV files in R</a></em> </p></div>



        </div>
    

      </div>
      
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="/assets/themes/noamblog/footnote-links.js"></script>
<script type="text/javascript">$('div.contenttext').footnoteLinks();</script>
</body>
</html>
